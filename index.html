<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caccia alla Parola</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #fdbb2d;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #fdbb2d;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        h2 {
            font-size: 1.8rem;
            margin: 15px 0;
            color: #fdbb2d;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
        }
        
        .team {
            text-align: center;
            flex: 1;
            padding: 10px;
        }
        
        .team-a {
            border-right: 1px solid #fdbb2d;
        }
        
        .team-name {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .score {
            font-size: 2rem;
            font-weight: bold;
            color: #fdbb2d;
        }
        
        .active-team {
            background-color: rgba(253, 187, 45, 0.2);
            border-radius: 10px;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .word-grid {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .letter-box {
            width: 60px;
            height: 60px;
            border: 2px solid #fdbb2d;
            margin: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .letter-box.revealed {
            background-color: rgba(253, 187, 45, 0.3);
            transform: scale(1.1);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        
        .buzzer {
            background-color: #e74c3c;
            color: white;
            font-size: 1.3rem;
        }
        
        .buzzer:hover {
            background-color: #c0392b;
            transform: translateY(-3px);
        }
        
        .buzzer:active {
            transform: translateY(1px);
        }
        
        .start-btn {
            background-color: #2ecc71;
            color: white;
        }
        
        .start-btn:hover {
            background-color: #27ae60;
        }
        
        .next-btn {
            background-color: #3498db;
            color: white;
        }
        
        .next-btn:hover {
            background-color: #2980b9;
        }
        
        .correct-btn {
            background-color: #2ecc71;
            color: white;
        }
        
        .wrong-btn {
            background-color: #e74c3c;
            color: white;
        }
        
        .next-game-btn {
            background-color: #9b59b6;
            color: white;
            font-size: 1.2rem;
            padding: 15px 30px;
        }
        
        .next-game-btn:hover {
            background-color: #8e44ad;
        }
        
        .round-info {
            font-size: 1.5rem;
            margin: 10px 0;
            text-align: center;
        }
        
        .message {
            text-align: center;
            font-size: 1.3rem;
            margin: 15px 0;
            min-height: 30px;
            padding: 10px;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .setup-screen {
            text-align: center;
        }
        
        .team-setup {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
        }
        
        .team-input {
            flex: 1;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 0 10px;
        }
        
        .team-input h3 {
            margin-bottom: 15px;
            color: #fdbb2d;
        }
        
        input {
            padding: 10px;
            margin: 8px 0;
            width: 100%;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .hidden {
            display: none;
        }
        
        .game-mode {
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.5rem;
            color: #fdbb2d;
            font-weight: bold;
        }
        
        .answer-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .player-name {
            font-size: 0.9rem;
            color: #fdbb2d;
            margin-top: 5px;
        }
        
        .game-completed {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(46, 204, 113, 0.2);
            border-radius: 10px;
            border: 2px solid #2ecc71;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease-in-out;
        }
        
        /* Stili per il video introduttivo */
        .intro-video-container {
            text-align: center;
            margin: 30px 0;
        }
        
        .intro-video {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        .skip-video-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .skip-video-btn:hover {
            background-color: #2980b9;
        }
        
        /* Stili per il secondo gioco */
        .quartina-container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
        }
        
        .quartina-line {
            margin: 15px 0;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.2rem;
        }
        
        .quartina-line.revealed {
            background-color: rgba(253, 187, 45, 0.2);
            border-left: 4px solid #fdbb2d;
        }
        
        .player-buzzers {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            gap: 10px;
        }
        
        .team-buzzers {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .player-buzzer {
            padding: 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .player-buzzer:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .player-buzzer:disabled {
            background-color: #7f8c8d;
            cursor: not-allowed;
            transform: none;
        }
        
        .player-buzzer.active {
            background-color: #e74c3c;
            animation: pulse 0.5s infinite;
        }
        
        .quartina-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .quartina-points {
            text-align: center;
            margin: 15px 0;
            font-size: 1.2rem;
            color: #fdbb2d;
        }
        
        .correct-answer {
            text-align: center;
            margin: 15px 0;
            padding: 10px;
            background-color: rgba(46, 204, 113, 0.2);
            border-radius: 8px;
            border: 1px solid #2ecc71;
        }
    </style>
</head>
<body>
    <!-- Schermata di setup -->
    <div class="container" id="setupScreen">
        <header>
            <h1>Caccia alla Parola</h1>
        </header>
        
        <div class="setup-screen">
            <h2>Configurazione Squadre</h2>
            
            <div class="team-setup">
                <div class="team-input">
                    <h3>Squadra A</h3>
                    <input type="text" id="teamAName" placeholder="Nome Squadra A" value="Squadra A">
                    <input type="text" id="playerA1" placeholder="Giocatore 1" value="Giocatore A1">
                    <input type="text" id="playerA2" placeholder="Giocatore 2" value="Giocatore A2">
                    <input type="text" id="playerA3" placeholder="Giocatore 3" value="Giocatore A3">
                </div>
                
                <div class="team-input">
                    <h3>Squadra B</h3>
                    <input type="text" id="teamBName" placeholder="Nome Squadra B" value="Squadra B">
                    <input type="text" id="playerB1" placeholder="Giocatore 1" value="Giocatore B1">
                    <input type="text" id="playerB2" placeholder="Giocatore 2" value="Giocatore B2">
                    <input type="text" id="playerB3" placeholder="Giocatore 3" value="Giocatore B3">
                </div>
            </div>
            
            <button class="start-btn" id="startGameBtn">Inizia il Gioco</button>
        </div>
    </div>
    
    <!-- Schermata del video introduttivo -->
    <div class="container hidden" id="introVideoScreen">
        <header>
            <h1>Caccia alla Parola</h1>
        </header>
        
        <div class="intro-video-container">
            <h2>Video Introduttivo</h2>
            <video class="intro-video" id="introVideo" controls>
                <!-- Sostituisci con il tuo video -->
                <source src="intro-video.mp4" type="video/mp4">
                Il tuo browser non supporta il tag video.
            </video>
            <div>
                <button class="skip-video-btn" id="skipVideoBtn">Salta Video</button>
            </div>
        </div>
    </div>
    
    <!-- Schermata di gioco principale (Caccia alla Parola) -->
    <div class="container hidden" id="gameScreen">
        <header>
            <h1>Caccia alla Parola</h1>
            <div class="game-mode" id="gameMode">Modalità: Caccia alla Parola</div>
        </header>
        
        <div class="game-info">
            <div class="team team-a" id="teamAElement">
                <div class="team-name" id="displayTeamA">Squadra A</div>
                <div class="score" id="scoreA">0</div>
                <div class="players">
                    <div id="displayPlayerA1">Giocatore 1</div>
                    <div id="displayPlayerA2">Giocatore 2</div>
                    <div id="displayPlayerA3">Giocatore 3</div>
                </div>
            </div>
            <div class="team" id="teamBElement">
                <div class="team-name" id="displayTeamB">Squadra B</div>
                <div class="score" id="scoreB">0</div>
                <div class="players">
                    <div id="displayPlayerB1">Giocatore 1</div>
                    <div id="displayPlayerB2">Giocatore 2</div>
                    <div id="displayPlayerB3">Giocatore 3</div>
                </div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="word-grid" id="wordGrid">
                <!-- Le lettere verranno aggiunte qui dinamicamente -->
            </div>
            
            <div class="round-info" id="roundInfo">Parola: 1/12</div>
            
            <div class="message" id="message">Premi "Inizia" per iniziare il gioco!</div>
            
            <div class="controls">
                <button class="start-btn" id="startBtn">Inizia</button>
                <button class="buzzer" id="buzzer">Buzzer</button>
                <button class="next-btn" id="nextBtn">Prossima Parola</button>
            </div>
            
            <div class="answer-controls hidden" id="answerControls">
                <div class="player-name" id="answeringPlayer"></div>
                <button class="correct-btn" id="correctBtn">Risposta Esatta</button>
                <button class="wrong-btn" id="wrongBtn">Risposta Errata</button>
            </div>
            
            <div class="game-completed hidden" id="gameCompleted">
                <h2>Gioco Completato!</h2>
                <p>Hai completato tutte le 12 parole del gioco "Caccia alla Parola"</p>
                <button class="next-game-btn" id="nextGameBtn">Prossimo Gioco: Quando, Dove, Come, Perché →</button>
            </div>
        </div>
    </div>

    <!-- Schermata del secondo gioco (Quando, Dove, Come, Perché) -->
    <div class="container hidden" id="secondGameScreen">
        <header>
            <h1>Quando, Dove, Come, Perché</h1>
            <div class="game-mode" id="secondGameMode">Modalità: Quando, Dove, Come, Perché</div>
        </header>
        
        <div class="game-info">
            <div class="team team-a" id="secondTeamAElement">
                <div class="team-name" id="secondDisplayTeamA">Squadra A</div>
                <div class="score" id="secondScoreA">0</div>
                <div class="players">
                    <div id="secondDisplayPlayerA1">Giocatore 1</div>
                    <div id="secondDisplayPlayerA2">Giocatore 2</div>
                    <div id="secondDisplayPlayerA3">Giocatore 3</div>
                </div>
            </div>
            <div class="team" id="secondTeamBElement">
                <div class="team-name" id="secondDisplayTeamB">Squadra B</div>
                <div class="score" id="secondScoreB">0</div>
                <div class="players">
                    <div id="secondDisplayPlayerB1">Giocatore 1</div>
                    <div id="secondDisplayPlayerB2">Giocatore 2</div>
                    <div id="secondDisplayPlayerB3">Giocatore 3</div>
                </div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="quartina-container">
                <div class="quartina-line" id="quandoLine">
                    <span id="quandoText">(Quando)</span>
                </div>
                <div class="quartina-line" id="doveLine">
                    <span id="doveText">(Dove)</span>
                </div>
                <div class="quartina-line" id="comeLine">
                    <span id="comeText">(Come)</span>
                </div>
                <div class="quartina-line" id="percheLine">
                    <span id="percheText">(Perché)</span>
                </div>
            </div>
            
            <div class="round-info" id="secondRoundInfo">Quartina: 1/4</div>
            
            <div class="quartina-points" id="quartinaPoints">
                Punti possibili: 20 (se indovinata dopo la prima affermazione: 40)
            </div>
            
            <div class="message" id="secondMessage">Premi "Inizia Quartina" per iniziare il gioco!</div>
            
            <div class="player-buzzers">
                <div class="team-buzzers">
                    <button class="player-buzzer" id="playerA1Buzzer" data-player="A1">Giocatore A1</button>
                    <button class="player-buzzer" id="playerA2Buzzer" data-player="A2">Giocatore A2</button>
                    <button class="player-buzzer" id="playerA3Buzzer" data-player="A3">Giocatore A3</button>
                </div>
                <div class="team-buzzers">
                    <button class="player-buzzer" id="playerB1Buzzer" data-player="B1">Giocatore B1</button>
                    <button class="player-buzzer" id="playerB2Buzzer" data-player="B2">Giocatore B2</button>
                    <button class="player-buzzer" id="playerB3Buzzer" data-player="B3">Giocatore B3</button>
                </div>
            </div>
            
            <div class="controls">
                <button class="start-btn" id="secondStartBtn">Inizia Quartina</button>
                <button class="next-btn" id="secondNextBtn">Prossima Affermazione</button>
                <button class="next-btn" id="secondNextQuartinaBtn">Prossima Quartina</button>
            </div>
            
            <div class="answer-controls hidden" id="secondAnswerControls">
                <div class="player-name" id="secondAnsweringPlayer"></div>
                <button class="correct-btn" id="secondCorrectBtn">Risposta Esatta</button>
                <button class="wrong-btn" id="secondWrongBtn">Risposta Errata</button>
            </div>
            
            <div class="correct-answer hidden" id="correctAnswerDisplay">
                <strong>Risposta corretta:</strong> <span id="correctAnswerText"></span>
            </div>
            
            <div class="game-completed hidden" id="secondGameCompleted">
                <h2>Gioco Completato!</h2>
                <p>Hai completato tutte le 4 quartine del gioco "Quando, Dove, Come, Perché"</p>
                <button class="next-game-btn" id="secondNextGameBtn">Torna al Menu Principale</button>
            </div>
        </div>
    </div>

    <script>
        // Variabili di gioco per Caccia alla Parola
        let currentWord = '';
        let revealedLetters = [];
        let currentLetterIndex = 0;
        let letterInterval;
        let gameStarted = false;
        let currentRound = 1;
        let totalRounds = 12;
        let scoreA = 0;
        let scoreB = 0;
        let currentTeam = 'A';
        let answeringPlayer = '';
        
        // Lista di parole LUNGHE e complesse (sempre nello stesso ordine)
        const wordList = [
            'AUTOMOBILE', 'TELEVISIONE', 'COMPUTER', 'BIBLIOTECA', 'GIARDINO',
            'ELEFANTE', 'CANGURO', 'DINOSAURO', 'AEROPORTO', 'UNIVERSITÀ',
            'RISTORANTE', 'OSPEDALE'
        ];
        
        // Variabili di gioco per Quando, Dove, Come, Perché
        let secondGameStarted = false;
        let secondCurrentRound = 1;
        let secondTotalRounds = 4;
        let currentQuartinaStep = 0;
        let currentAnsweringPlayer = '';
        let currentAnsweringTeam = '';
        let quartinaPoints = 20;
        
        // Lista di quartine (Quando, Dove, Come, Perché, Risposta)
        const quartineList = [
            {
                quando: "La notte di Natale...",
                dove: "... attorno a un tavolo...",
                come: "... con dei fagioli in mano...",
                perche: "... per fare cinquina!",
                risposta: "TOMBOLA"
            },
            {
                quando: "Nel 1969...",
                dove: "... sulla Luna...",
                come: "... con un piccolo passo...",
                perche: "... per l'umanità!",
                risposta: "ALLUNAGGIO"
            },
            {
                quando: "Nel Rinascimento...",
                dove: "... a Firenze...",
                come: "... con genio e creatività...",
                perche: "... per dare vita a capolavori!",
                risposta: "LEONARDO DA VINCI"
            },
            {
                quando: "Ogni quattro anni...",
                dove: "... in tutto il mondo...",
                come: "... con atleti e bandiere...",
                perche: "... per l'onore della propria nazione!",
                risposta: "OLIMPIADI"
            }
        ];
        
        // Elementi DOM per Caccia alla Parola
        const setupScreen = document.getElementById('setupScreen');
        const introVideoScreen = document.getElementById('introVideoScreen');
        const introVideo = document.getElementById('introVideo');
        const skipVideoBtn = document.getElementById('skipVideoBtn');
        const gameScreen = document.getElementById('gameScreen');
        const wordGrid = document.getElementById('wordGrid');
        const message = document.getElementById('message');
        const startBtn = document.getElementById('startBtn');
        const buzzer = document.getElementById('buzzer');
        const nextBtn = document.getElementById('nextBtn');
        const scoreAElement = document.getElementById('scoreA');
        const scoreBElement = document.getElementById('scoreB');
        const roundInfoElement = document.getElementById('roundInfo');
        const gameModeElement = document.getElementById('gameMode');
        const startGameBtn = document.getElementById('startGameBtn');
        const answerControls = document.getElementById('answerControls');
        const correctBtn = document.getElementById('correctBtn');
        const wrongBtn = document.getElementById('wrongBtn');
        const answeringPlayerElement = document.getElementById('answeringPlayer');
        const gameCompleted = document.getElementById('gameCompleted');
        const nextGameBtn = document.getElementById('nextGameBtn');
        const teamAElement = document.getElementById('teamAElement');
        const teamBElement = document.getElementById('teamBElement');
        
        // Elementi per i nomi delle squadre
        const teamANameInput = document.getElementById('teamAName');
        const playerA1Input = document.getElementById('playerA1');
        const playerA2Input = document.getElementById('playerA2');
        const playerA3Input = document.getElementById('playerA3');
        const teamBNameInput = document.getElementById('teamBName');
        const playerB1Input = document.getElementById('playerB1');
        const playerB2Input = document.getElementById('playerB2');
        const playerB3Input = document.getElementById('playerB3');
        
        const displayTeamA = document.getElementById('displayTeamA');
        const displayPlayerA1 = document.getElementById('displayPlayerA1');
        const displayPlayerA2 = document.getElementById('displayPlayerA2');
        const displayPlayerA3 = document.getElementById('displayPlayerA3');
        const displayTeamB = document.getElementById('displayTeamB');
        const displayPlayerB1 = document.getElementById('displayPlayerB1');
        const displayPlayerB2 = document.getElementById('displayPlayerB2');
        const displayPlayerB3 = document.getElementById('displayPlayerB3');
        
        // Elementi DOM per Quando, Dove, Come, Perché
        const secondGameScreen = document.getElementById('secondGameScreen');
        const secondDisplayTeamA = document.getElementById('secondDisplayTeamA');
        const secondDisplayPlayerA1 = document.getElementById('secondDisplayPlayerA1');
        const secondDisplayPlayerA2 = document.getElementById('secondDisplayPlayerA2');
        const secondDisplayPlayerA3 = document.getElementById('secondDisplayPlayerA3');
        const secondDisplayTeamB = document.getElementById('secondDisplayTeamB');
        const secondDisplayPlayerB1 = document.getElementById('secondDisplayPlayerB1');
        const secondDisplayPlayerB2 = document.getElementById('secondDisplayPlayerB2');
        const secondDisplayPlayerB3 = document.getElementById('secondDisplayPlayerB3');
        const secondScoreA = document.getElementById('secondScoreA');
        const secondScoreB = document.getElementById('secondScoreB');
        const secondTeamAElement = document.getElementById('secondTeamAElement');
        const secondTeamBElement = document.getElementById('secondTeamBElement');
        const quandoLine = document.getElementById('quandoLine');
        const doveLine = document.getElementById('doveLine');
        const comeLine = document.getElementById('comeLine');
        const percheLine = document.getElementById('percheLine');
        const quandoText = document.getElementById('quandoText');
        const doveText = document.getElementById('doveText');
        const comeText = document.getElementById('comeText');
        const percheText = document.getElementById('percheText');
        const secondRoundInfo = document.getElementById('secondRoundInfo');
        const secondMessage = document.getElementById('secondMessage');
        const secondStartBtn = document.getElementById('secondStartBtn');
        const secondNextBtn = document.getElementById('secondNextBtn');
        const secondNextQuartinaBtn = document.getElementById('secondNextQuartinaBtn');
        const secondAnswerControls = document.getElementById('secondAnswerControls');
        const secondAnsweringPlayer = document.getElementById('secondAnsweringPlayer');
        const secondCorrectBtn = document.getElementById('secondCorrectBtn');
        const secondWrongBtn = document.getElementById('secondWrongBtn');
        const secondGameCompleted = document.getElementById('secondGameCompleted');
        const secondNextGameBtn = document.getElementById('secondNextGameBtn');
        const quartinaPointsElement = document.getElementById('quartinaPoints');
        const correctAnswerDisplay = document.getElementById('correctAnswerDisplay');
        const correctAnswerText = document.getElementById('correctAnswerText');
        
        // Buzzers per i giocatori
        const playerA1Buzzer = document.getElementById('playerA1Buzzer');
        const playerA2Buzzer = document.getElementById('playerA2Buzzer');
        const playerA3Buzzer = document.getElementById('playerA3Buzzer');
        const playerB1Buzzer = document.getElementById('playerB1Buzzer');
        const playerB2Buzzer = document.getElementById('playerB2Buzzer');
        const playerB3Buzzer = document.getElementById('playerB3Buzzer');
        
        // Aggiorna la visualizzazione delle squadre attive
        function updateActiveTeam() {
            if (currentTeam === 'A') {
                teamAElement.classList.add('active-team');
                teamBElement.classList.remove('active-team');
            } else {
                teamBElement.classList.add('active-team');
                teamAElement.classList.remove('active-team');
            }
        }
        
        // Inizializzazione del gioco Caccia alla Parola
        function initGame() {
            resetGame();
            updateScores();
            updateActiveTeam();
            roundInfoElement.textContent = `Parola: ${currentRound}/${totalRounds}`;
            message.textContent = `Inizia la ${displayTeamA.textContent}!`;
        }
        
        // Reset del gioco Caccia alla Parola
        function resetGame() {
            clearInterval(letterInterval);
            gameStarted = false;
            revealedLetters = [];
            currentLetterIndex = 0;
            wordGrid.innerHTML = '';
            buzzer.disabled = true;
            nextBtn.disabled = true;
            answerControls.classList.add('hidden');
        }
        
        // Avvia il gioco Caccia alla Parola
        function startGame() {
            if (gameStarted) return;
            
            gameStarted = true;
            // Prende la parola corrente dalla lista FISSA
            currentWord = wordList[currentRound - 1];
            createWordGrid();
            startRevealingLetters();
            message.textContent = `Indovina la parola! Tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            buzzer.disabled = false;
            startBtn.disabled = true;
            nextBtn.disabled = true;
        }
        
        // Crea la griglia per la parola
        function createWordGrid() {
            wordGrid.innerHTML = '';
            for (let i = 0; i < currentWord.length; i++) {
                const letterBox = document.createElement('div');
                letterBox.className = 'letter-box';
                letterBox.id = `letter-${i}`;
                wordGrid.appendChild(letterBox);
            }
        }
        
        // Inizia a rivelare le lettere
        function startRevealingLetters() {
            const positions = Array.from({length: currentWord.length}, (_, i) => i);
            shuffleArray(positions);
            
            letterInterval = setInterval(() => {
                if (currentLetterIndex >= currentWord.length) {
                    // Tutte le lettere sono state rivelate, ma il gioco continua
                    // finché qualcuno non preme il buzzer
                    return;
                }
                
                const pos = positions[currentLetterIndex];
                revealLetter(pos);
                currentLetterIndex++;
            }, 1500); // 1.5 secondi tra le lettere
        }
        
        // Rivela una lettera
        function revealLetter(position) {
            const letterBox = document.getElementById(`letter-${position}`);
            letterBox.textContent = currentWord[position];
            letterBox.classList.add('revealed');
            letterBox.classList.add('pulse');
            revealedLetters.push(currentWord[position]);
            
            setTimeout(() => {
                letterBox.classList.remove('pulse');
            }, 500);
        }
        
        // Gestisce la pressione del buzzer
        function handleBuzzer() {
            if (!gameStarted) return;
            
            clearInterval(letterInterval);
            
            // Seleziona casualmente un giocatore della squadra corrente
            const players = currentTeam === 'A' 
                ? [playerA1Input.value, playerA2Input.value, playerA3Input.value]
                : [playerB1Input.value, playerB2Input.value, playerB3Input.value];
            
            answeringPlayer = players[Math.floor(Math.random() * players.length)];
            answeringPlayerElement.textContent = `Risponde: ${answeringPlayer}`;
            
            const teamName = currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent;
            
            message.textContent = `${teamName}, qual è la parola?`;
            buzzer.disabled = true;
            answerControls.classList.remove('hidden');
        }
        
        // Gestisce una risposta corretta
        function handleCorrectAnswer() {
            message.textContent = `Esatto! La parola è "${currentWord}". Punto per la ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            revealAllLetters();
            updateScore(currentTeam, 10);
            nextBtn.disabled = false;
            answerControls.classList.add('hidden');
            
            // Cambia squadra per la prossima parola
            currentTeam = currentTeam === 'A' ? 'B' : 'A';
            updateActiveTeam();
            message.textContent += ` Adesso tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
        }
        
        // Gestisce una risposta errata
        function handleWrongAnswer() {
            // Cambia squadra
            currentTeam = currentTeam === 'A' ? 'B' : 'A';
            updateActiveTeam();
            
            message.textContent = `Risposta errata! Adesso tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            answerControls.classList.add('hidden');
            startRevealingLetters();
            buzzer.disabled = false;
        }
        
        // Rivela tutte le lettere
        function revealAllLetters() {
            for (let i = 0; i < currentWord.length; i++) {
                const letterBox = document.getElementById(`letter-${i}`);
                if (!letterBox.textContent) {
                    letterBox.textContent = currentWord[i];
                    letterBox.classList.add('revealed');
                }
            }
        }
        
        // Passa alla parola successiva
        function nextWord() {
            currentRound++;
            if (currentRound > totalRounds) {
                completeGame();
                return;
            }
            
            roundInfoElement.textContent = `Parola: ${currentRound}/${totalRounds}`;
            resetGame();
            startBtn.disabled = false;
            updateActiveTeam();
            message.textContent = `Prossima parola! Inizia la ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
        }
        
        // Completa il gioco Caccia alla Parola
        function completeGame() {
            message.textContent = 'Hai completato tutte le parole!';
            startBtn.disabled = true;
            buzzer.disabled = true;
            nextBtn.disabled = true;
            gameCompleted.classList.remove('hidden');
        }
        
        // Aggiorna il punteggio
        function updateScore(team, points) {
            if (team === 'A') {
                scoreA += points;
                scoreAElement.textContent = scoreA;
                secondScoreA.textContent = scoreA;
            } else {
                scoreB += points;
                scoreBElement.textContent = scoreB;
                secondScoreB.textContent = scoreB;
            }
        }
        
        // Funzione per mescolare un array (algoritmo Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // Inizia il gioco principale dopo il setup
        function startMainGame() {
            // Aggiorna i nomi delle squadre e dei giocatori
            displayTeamA.textContent = teamANameInput.value;
            displayPlayerA1.textContent = playerA1Input.value;
            displayPlayerA2.textContent = playerA2Input.value;
            displayPlayerA3.textContent = playerA3Input.value;
            
            displayTeamB.textContent = teamBNameInput.value;
            displayPlayerB1.textContent = playerB1Input.value;
            displayPlayerB2.textContent = playerB2Input.value;
            displayPlayerB3.textContent = playerB3Input.value;
            
            // Aggiorna anche per il secondo gioco
            secondDisplayTeamA.textContent = teamANameInput.value;
            secondDisplayPlayerA1.textContent = playerA1Input.value;
            secondDisplayPlayerA2.textContent = playerA2Input.value;
            secondDisplayPlayerA3.textContent = playerA3Input.value;
            
            secondDisplayTeamB.textContent = teamBNameInput.value;
            secondDisplayPlayerB1.textContent = playerB1Input.value;
            secondDisplayPlayerB2.textContent = playerB2Input.value;
            secondDisplayPlayerB3.textContent = playerB3Input.value;
            
            // Aggiorna anche i pulsanti dei buzzers con i nomi corretti
            playerA1Buzzer.textContent = playerA1Input.value;
            playerA2Buzzer.textContent = playerA2Input.value;
            playerA3Buzzer.textContent = playerA3Input.value;
            playerB1Buzzer.textContent = playerB1Input.value;
            playerB2Buzzer.textContent = playerB2Input.value;
            playerB3Buzzer.textContent = playerB3Input.value;
            
            // Nasconde la schermata di setup e mostra il video introduttivo
            setupScreen.classList.add('hidden');
            introVideoScreen.classList.remove('hidden');
            
            // Riproduce automaticamente il video
            introVideo.play();
        }
        
        // Salta il video e passa direttamente al gioco
        function skipVideo() {
            introVideoScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            initGame();
        }
        
        // Passa al secondo gioco
        function startSecondGame() {
            // Nasconde il primo gioco e mostra il secondo
            gameScreen.classList.add('hidden');
            secondGameScreen.classList.remove('hidden');
            
            // Inizializza il secondo gioco
            initSecondGame();
        }
        
        // Inizializzazione del secondo gioco
        function initSecondGame() {
            resetSecondGame();
            updateSecondScores();
            secondRoundInfo.textContent = `Quartina: ${secondCurrentRound}/${secondTotalRounds}`;
            secondMessage.textContent = `Premi "Inizia Quartina" per iniziare!`;
            quartinaPoints = 20;
            quartinaPointsElement.textContent = `Punti possibili: ${quartinaPoints} (se indovinata dopo la prima affermazione: 40)`;
        }
        
        // Reset del secondo gioco
        function resetSecondGame() {
            secondGameStarted = false;
            currentQuartinaStep = 0;
            resetQuartinaDisplay();
            enableAllBuzzers(false);
            secondStartBtn.disabled = false;
            secondNextBtn.disabled = true;
            secondNextQuartinaBtn.disabled = true;
            secondAnswerControls.classList.add('hidden');
            correctAnswerDisplay.classList.add('hidden');
        }
        
        // Reset della visualizzazione della quartina
        function resetQuartinaDisplay() {
            quandoLine.classList.remove('revealed');
            doveLine.classList.remove('revealed');
            comeLine.classList.remove('revealed');
            percheLine.classList.remove('revealed');
            
            quandoText.textContent = "(Quando)";
            doveText.textContent = "(Dove)";
            comeText.textContent = "(Come)";
            percheText.textContent = "(Perché)";
        }
        
        // Abilita/disabilita tutti i buzzers
        function enableAllBuzzers(enable) {
            playerA1Buzzer.disabled = !enable;
            playerA2Buzzer.disabled = !enable;
            playerA3Buzzer.disabled = !enable;
            playerB1Buzzer.disabled = !enable;
            playerB2Buzzer.disabled = !enable;
            playerB3Buzzer.disabled = !enable;
            
            // Rimuove la classe active da tutti i buzzers
            playerA1Buzzer.classList.remove('active');
            playerA2Buzzer.classList.remove('active');
            playerA3Buzzer.classList.remove('active');
            playerB1Buzzer.classList.remove('active');
            playerB2Buzzer.classList.remove('active');
            playerB3Buzzer.classList.remove('active');
        }
        
        // Avvia il secondo gioco
        function startSecondGameRound() {
            if (secondGameStarted) return;
            
            secondGameStarted = true;
            currentQuartinaStep = 0;
            secondStartBtn.disabled = true;
            secondNextBtn.disabled = false;
            secondNextQuartinaBtn.disabled = true;
            enableAllBuzzers(true);
            
            // Mostra la prima affermazione (Quando)
            revealQuartinaStep();
            secondMessage.textContent = "Indovina a cosa si riferisce la quartina!";
            quartinaPoints = 40; // Doppio punteggio se indovinato dopo la prima affermazione
            quartinaPointsElement.textContent = `Punti possibili: ${quartinaPoints}`;
        }
        
        // Rivela il passo successivo della quartina
        function revealNextQuartinaStep() {
            if (currentQuartinaStep >= 3) return;
            
            currentQuartinaStep++;
            revealQuartinaStep();
            
            // Aggiorna i punti possibili
            if (currentQuartinaStep === 1) {
                quartinaPoints = 30;
            } else if (currentQuartinaStep === 2) {
                quartinaPoints = 20;
            } else if (currentQuartinaStep === 3) {
                quartinaPoints = 10;
            }
            quartinaPointsElement.textContent = `Punti possibili: ${quartinaPoints}`;
            
            // Se tutte le affermazioni sono state rivelate
            if (currentQuartinaStep === 3) {
                secondNextBtn.disabled = true;
                secondNextQuartinaBtn.disabled = false;
                secondMessage.textContent = "Quartina completata! Nessuno ha indovinato.";
                showCorrectAnswer();
            }
        }
        
        // Rivela il passo corrente della quartina
        function revealQuartinaStep() {
            const currentQuartina = quartineList[secondCurrentRound - 1];
            
            if (currentQuartinaStep >= 0) {
                quandoLine.classList.add('revealed');
                quandoText.textContent = currentQuartina.quando;
            }
            
            if (currentQuartinaStep >= 1) {
                doveLine.classList.add('revealed');
                doveText.textContent = currentQuartina.dove;
            }
            
            if (currentQuartinaStep >= 2) {
                comeLine.classList.add('revealed');
                comeText.textContent = currentQuartina.come;
            }
            
            if (currentQuartinaStep >= 3) {
                percheLine.classList.add('revealed');
                percheText.textContent = currentQuartina.perche;
            }
        }
        
        // Mostra la risposta corretta
        function showCorrectAnswer() {
            const currentQuartina = quartineList[secondCurrentRound - 1];
            correctAnswerText.textContent = currentQuartina.risposta;
            correctAnswerDisplay.classList.remove('hidden');
        }
        
        // Gestisce la pressione di un buzzer da parte di un giocatore
        function handlePlayerBuzzer(event) {
            if (!secondGameStarted) return;
            
            const playerBuzzer = event.target;
            const playerId = playerBuzzer.getAttribute('data-player');
            
            // Disabilita tutti i buzzers
            enableAllBuzzers(false);
            
            // Attiva il buzzer premuto
            playerBuzzer.classList.add('active');
            
            // Determina il giocatore e la squadra
            let playerName = '';
            let team = '';
            
            if (playerId.startsWith('A')) {
                team = 'A';
                if (playerId === 'A1') playerName = playerA1Input.value;
                else if (playerId === 'A2') playerName = playerA2Input.value;
                else if (playerId === 'A3') playerName = playerA3Input.value;
            } else {
                team = 'B';
                if (playerId === 'B1') playerName = playerB1Input.value;
                else if (playerId === 'B2') playerName = playerB2Input.value;
                else if (playerId === 'B3') playerName = playerB3Input.value;
            }
            
            currentAnsweringPlayer = playerName;
            currentAnsweringTeam = team;
            
            secondAnsweringPlayer.textContent = `Risponde: ${playerName} (${team === 'A' ? displayTeamA.textContent : displayTeamB.textContent})`;
            secondMessage.textContent = `${playerName} ha premuto il buzzer! Ascolta la risposta e premi "Risposta Esatta" o "Risposta Errata".`;
            secondAnswerControls.classList.remove('hidden');
        }
        
        // Gestisce una risposta corretta nel secondo gioco
        function handleSecondCorrectAnswer() {
            const currentQuartina = quartineList[secondCurrentRound - 1];
            
            secondMessage.textContent = `Esatto! La risposta è "${currentQuartina.risposta}". ${quartinaPoints} punti per la ${currentAnsweringTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            updateScore(currentAnsweringTeam, quartinaPoints);
            
            // Rivela tutta la quartina
            revealAllQuartinaSteps();
            
            secondNextQuartinaBtn.disabled = false;
            secondAnswerControls.classList.add('hidden');
            correctAnswerDisplay.classList.add('hidden');
        }
        
        // Gestisce una risposta errata nel secondo gioco
        function handleSecondWrongAnswer() {
            secondMessage.textContent = "Risposta errata! La quartina continua...";
            // Abilita di nuovo i buzzers
            enableAllBuzzers(true);
            secondAnswerControls.classList.add('hidden');
        }
        
        // Rivela tutti i passi della quartina
        function revealAllQuartinaSteps() {
            currentQuartinaStep = 3;
            revealQuartinaStep();
        }
        
        // Passa alla quartina successiva
        function nextQuartina() {
            secondCurrentRound++;
            if (secondCurrentRound > secondTotalRounds) {
                completeSecondGame();
                return;
            }
            
            secondRoundInfo.textContent = `Quartina: ${secondCurrentRound}/${secondTotalRounds}`;
            resetSecondGame();
            secondMessage.textContent = `Prossima quartina! Premi "Inizia Quartina" per iniziare.`;
        }
        
        // Completa il secondo gioco
        function completeSecondGame() {
            secondMessage.textContent = 'Hai completato tutte le quartine!';
            secondStartBtn.disabled = true;
            secondNextBtn.disabled = true;
            secondNextQuartinaBtn.disabled = true;
            enableAllBuzzers(false);
            secondGameCompleted.classList.remove('hidden');
        }
        
        // Torna al menu principale
        function backToMainMenu() {
            secondGameScreen.classList.add('hidden');
            setupScreen.classList.remove('hidden');
            
            // Resetta i giochi
            currentRound = 1;
            secondCurrentRound = 1;
            scoreA = 0;
            scoreB = 0;
            updateScores();
            initGame();
        }
        
        // Aggiorna i punteggi per entrambi i giochi
        function updateScores() {
            scoreAElement.textContent = scoreA;
            scoreBElement.textContent = scoreB;
            secondScoreA.textContent = scoreA;
            secondScoreB.textContent = scoreB;
        }
        
        // Aggiorna i punteggi per il secondo gioco
        function updateSecondScores() {
            secondScoreA.textContent = scoreA;
            secondScoreB.textContent = scoreB;
        }
        
        // Aggiungi event listeners per il primo gioco
        startBtn.addEventListener('click', startGame);
        buzzer.addEventListener('click', handleBuzzer);
        nextBtn.addEventListener('click', nextWord);
        startGameBtn.addEventListener('click', startMainGame);
        correctBtn.addEventListener('click', handleCorrectAnswer);
        wrongBtn.addEventListener('click', handleWrongAnswer);
        nextGameBtn.addEventListener('click', startSecondGame);
        
        // Aggiungi event listeners per il video introduttivo
        skipVideoBtn.addEventListener('click', skipVideo);
        introVideo.addEventListener('ended', skipVideo);
        
        // Aggiungi event listeners per il secondo gioco
        secondStartBtn.addEventListener('click', startSecondGameRound);
        secondNextBtn.addEventListener('click', revealNextQuartinaStep);
        secondNextQuartinaBtn.addEventListener('click', nextQuartina);
        secondCorrectBtn.addEventListener('click', handleSecondCorrectAnswer);
        secondWrongBtn.addEventListener('click', handleSecondWrongAnswer);
        secondNextGameBtn.addEventListener('click', backToMainMenu);
        
        // Aggiungi event listeners per i buzzers dei giocatori
        playerA1Buzzer.addEventListener('click', handlePlayerBuzzer);
        playerA2Buzzer.addEventListener('click', handlePlayerBuzzer);
        playerA3Buzzer.addEventListener('click', handlePlayerBuzzer);
        playerB1Buzzer.addEventListener('click', handlePlayerBuzzer);
        playerB2Buzzer.addEventListener('click', handlePlayerBuzzer);
        playerB3Buzzer.addEventListener('click', handlePlayerBuzzer);
        
        // Inizializza il gioco
        initGame();
    </script>
</body>
</html>
