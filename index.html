<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laureata a Catena</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* RESET E STILI BASE */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
        }
        
        :root {
            --primary: #1a2a6c;
            --secondary: #b21f1f;
            --accent: #fdbb2d;
            --success: #2ecc71;
            --danger: #e74c3c;
            --info: #3498db;
            --dark: #0d1426;
            --light: #f8f9fa;
            --card-bg: rgba(13, 20, 38, 0.92);
            --transition: all 0.3s ease;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            --glow: 0 0 15px rgba(253, 187, 45, 0.6);
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
            color: var(--light);
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 2px solid var(--accent);
            min-height: 95vh;
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.05), rgba(26, 42, 108, 0.05));
            z-index: -1;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--accent);
            flex-shrink: 0;
            position: relative;
        }
        
        header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--accent);
            border-radius: 2px;
        }
        
        h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: 10px;
            color: var(--accent);
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7);
            font-weight: 800;
            letter-spacing: 1px;
            position: relative;
            display: inline-block;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
        }
        
        h2 {
            font-size: clamp(1.3rem, 3vw, 1.8rem);
            margin: 10px 0;
            color: var(--light);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            font-weight: 500;
        }
        
        /* STILI PER IL GIOCO PRINCIPALE */
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.1), rgba(26, 42, 108, 0.2));
            padding: 15px;
            border-radius: 15px;
            border: 2px solid rgba(253, 187, 45, 0.3);
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }
        
        .game-info::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .team {
            text-align: center;
            flex: 1;
            padding: 15px;
            transition: var(--transition);
            border-radius: 12px;
            position: relative;
            z-index: 1;
        }
        
        .team-a {
            border-right: 2px solid var(--accent);
        }
        
        .team-name {
            font-size: clamp(1.3rem, 3vw, 1.6rem);
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .score {
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            font-weight: bold;
            color: var(--accent);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin: 10px 0;
            position: relative;
            display: inline-block;
        }
        
        .score::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
        }
        
        .active-team {
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.3), rgba(178, 31, 31, 0.2));
            transform: scale(1.05);
            box-shadow: var(--glow);
            border: 2px solid var(--accent);
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            flex-grow: 1;
            overflow: hidden;
            padding: 10px;
        }
        
        .word-grid {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 100%;
            overflow: hidden;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 2px solid rgba(253, 187, 45, 0.3);
        }
        
        .letter-box {
            width: clamp(60px, 8vw, 75px);
            height: clamp(60px, 8vw, 75px);
            border: 3px solid var(--accent);
            margin: 2px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: bold;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 12px;
            transition: var(--transition);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .letter-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: var(--transition);
        }
        
        .letter-box:hover::before {
            left: 100%;
        }
        
        .letter-box.revealed {
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.4), rgba(253, 187, 45, 0.2));
            transform: scale(1.1);
            box-shadow: var(--glow);
            border-color: var(--accent);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-shrink: 0;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 20px;
            font-size: clamp(1rem, 2.2vw, 1.2rem);
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: var(--transition);
        }
        
        button:hover::after {
            left: 100%;
        }
        
        .buzzer {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            color: white;
            font-size: clamp(1.1rem, 2.8vw, 1.4rem);
            padding: 15px 30px;
            box-shadow: 0 8px 15px rgba(231, 76, 60, 0.4);
        }
        
        .buzzer:hover {
            background: linear-gradient(135deg, #c0392b, #a93226);
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(231, 76, 60, 0.6);
        }
        
        .buzzer:active {
            transform: translateY(2px);
        }
        
        .start-btn {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
        }
        
        .start-btn:hover {
            background: linear-gradient(135deg, #27ae60, #219a52);
            transform: translateY(-3px);
        }
        
        .next-btn {
            background: linear-gradient(135deg, var(--info), #2980b9);
            color: white;
        }
        
        .next-btn:hover {
            background: linear-gradient(135deg, #2980b9, #21618c);
            transform: translateY(-3px);
        }
        
        .correct-btn {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
            padding: 10px 20px;
        }
        
        .wrong-btn {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            color: white;
            padding: 10px 20px;
        }
        
        .next-game-btn {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            font-size: clamp(1.1rem, 2.2vw, 1.3rem);
            padding: 15px 25px;
        }
        
        .next-game-btn:hover {
            background: linear-gradient(135deg, #8e44ad, #7d3c98);
            transform: translateY(-3px);
        }
        
        .round-info {
            font-size: clamp(1.2rem, 2.8vw, 1.5rem);
            margin: 15px 0;
            text-align: center;
            color: var(--accent);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            font-weight: bold;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid rgba(253, 187, 45, 0.3);
        }
        
        .message {
            text-align: center;
            font-size: clamp(1.1rem, 2.2vw, 1.3rem);
            margin: 15px 0;
            min-height: 50px;
            padding: 15px;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 2px solid rgba(253, 187, 45, 0.3);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .message::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .setup-screen {
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
        }
        
        .team-setup {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            gap: 20px;
        }
        
        .team-input {
            flex: 1;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 15px;
            border: 2px solid rgba(253, 187, 45, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .team-input::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .team-input h3 {
            margin-bottom: 15px;
            color: var(--accent);
            font-size: clamp(1.2rem, 2.2vw, 1.4rem);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        input {
            padding: 12px;
            margin: 10px 0;
            width: 100%;
            border: none;
            border-radius: 10px;
            font-size: clamp(1rem, 1.8vw, 1.1rem);
            background: rgba(255, 255, 255, 0.9);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            border: 2px solid transparent;
        }
        
        input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(253, 187, 45, 0.5);
            border-color: var(--accent);
        }
        
        .hidden {
            display: none !important;
        }
        
        .game-mode {
            text-align: center;
            margin-bottom: 15px;
            font-size: clamp(1.2rem, 2.2vw, 1.4rem);
            color: var(--accent);
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid rgba(253, 187, 45, 0.3);
        }
        
        .answer-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .player-name {
            font-size: clamp(1rem, 1.8vw, 1.1rem);
            color: var(--accent);
            margin-top: 10px;
            font-weight: bold;
            padding: 8px 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border: 1px solid rgba(253, 187, 45, 0.3);
        }
        
        .game-completed {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.3), rgba(39, 174, 96, 0.2));
            border-radius: 15px;
            border: 3px solid var(--success);
            position: relative;
            overflow: hidden;
        }
        
        .game-completed::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease-in-out;
        }
        
        @keyframes glow {
            0% { box-shadow: 0 0 10px rgba(253, 187, 45, 0.6); }
            50% { box-shadow: 0 0 20px rgba(253, 187, 45, 0.9); }
            100% { box-shadow: 0 0 10px rgba(253, 187, 45, 0.6); }
        }
        
        .glow {
            animation: glow 1s infinite;
        }
        
        /* STILI PER IL SECONDO GIOCO */
        .quartina-container {
            width: 100%;
            max-width: 800px;
            margin: 15px auto;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(253, 187, 45, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .quartina-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .quartina-line {
            margin: 12px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            min-height: 55px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: clamp(1.1rem, 2vw, 1.3rem);
            transition: var(--transition);
            border-left: 5px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .quartina-line::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .quartina-line.revealed {
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.2), rgba(253, 187, 45, 0.1));
            border-left: 5px solid var(--accent);
            transform: translateX(5px);
        }
        
        .player-buzzers {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            gap: 15px;
        }
        
        .team-buzzers {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .player-buzzer {
            padding: 12px;
            background: linear-gradient(135deg, var(--info), #2980b9);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            font-size: clamp(1rem, 1.8vw, 1.1rem);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .player-buzzer:hover {
            background: linear-gradient(135deg, #2980b9, #21618c);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .player-buzzer:disabled {
            background: linear-gradient(135deg, #7f8c8d, #6c7a7d);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .player-buzzer.active {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            animation: pulse 0.5s infinite;
            box-shadow: 0 0 15px rgba(231, 76, 60, 0.6);
        }
        
        .quartina-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .quartina-points {
            text-align: center;
            margin: 15px 0;
            font-size: clamp(1.1rem, 2vw, 1.3rem);
            color: var(--accent);
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid rgba(253, 187, 45, 0.3);
        }
        
        .correct-answer {
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.3), rgba(39, 174, 96, 0.2));
            border-radius: 12px;
            border: 2px solid var(--success);
            font-size: clamp(1rem, 1.8vw, 1.2rem);
            position: relative;
            overflow: hidden;
        }
        
        .correct-answer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Uc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        /* STILI PER IL TERZO GIOCO (Una tira l'altra) */
        .chain-container {
            width: 100%;
            max-width: 800px;
            margin: 15px auto;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(253, 187, 45, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .chain-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .chain-word {
            margin: 12px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: clamp(1.2rem, 2.2vw, 1.4rem);
            transition: var(--transition);
            border-left: 5px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .chain-word::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .chain-word.revealed {
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.2), rgba(253, 187, 45, 0.1));
            border-left: 5px solid var(--accent);
            transform: translateX(5px);
        }
        
        .chain-word.hidden-word {
            background: linear-gradient(135deg, rgba(178, 31, 31, 0.3), rgba(178, 31, 31, 0.2));
            border-left: 5px solid var(--secondary);
        }
        
        .chain-word.hidden-word.revealed {
            background: linear-gradient(135deg, rgba(253, 187, 45, 0.2), rgba(253, 187, 45, 0.1));
            border-left: 5px solid var(--accent);
        }
        
        .chain-direction {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .direction-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            font-size: clamp(1rem, 1.8vw, 1.1rem);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .direction-btn:hover {
            background: linear-gradient(135deg, #8e44ad, #7d3c98);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .direction-btn.active {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            box-shadow: 0 0 15px rgba(231, 76, 60, 0.6);
        }
        
        .zip-container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(253, 187, 45, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .zip-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .zip-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .zip-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #f1c40f, #f39c12);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            font-size: clamp(1.1rem, 2vw, 1.3rem);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .zip-btn:hover {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .zip-prize {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.3), rgba(39, 174, 96, 0.2));
            border-radius: 12px;
            border: 2px solid var(--success);
            font-size: clamp(1.1rem, 2vw, 1.3rem);
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        .zip-prize::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }

        /* Timer per la ZIP */
        .zip-timer {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.3), rgba(192, 57, 43, 0.2));
            border-radius: 12px;
            border: 2px solid var(--danger);
            font-size: clamp(1.3rem, 2.5vw, 1.6rem);
            font-weight: bold;
            color: var(--accent);
            position: relative;
            overflow: hidden;
        }
        
        .zip-timer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }

        /* STILI PER LA SIGLA - MODIFICATI PER AVERLA A TUTTO SCHERMO */
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .intro-video {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Fa s√¨ che il video copra tutto lo schermo */
            position: absolute;
            top: 0;
            left: 0;
        }
        
        .play-intro-btn {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            padding: 18px 35px;
            background: linear-gradient(135deg, var(--accent), #f39c12);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.5);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .play-intro-btn:hover {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            transform: translateX(-50%) translateY(-3px);
        }
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9998;
            color: white;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 25px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* MUSICA NASCOSTA */
        #introMusic {
            display: none;
        }

        /* TIMER PER LA MUSICA */
        .music-timer {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.8);
            color: var(--accent);
            padding: 10px 15px;
            border-radius: 10px;
            font-size: clamp(1rem, 1.8vw, 1.1rem);
            font-weight: bold;
            z-index: 1000;
            border: 2px solid var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        /* STILI PER L'INTESA VINCENTE */
        .intesa-container {
            width: 100%;
            max-width: 900px;
            margin: 15px auto;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(253, 187, 45, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .intesa-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .intesa-timer {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.3), rgba(192, 57, 43, 0.2));
            border-radius: 12px;
            border: 2px solid var(--danger);
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: bold;
            color: var(--accent);
            position: relative;
            overflow: hidden;
        }
        
        .intesa-timer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .hidden-word-display {
            text-align: center;
            margin: 20px 0;
            padding: 25px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: bold;
            border: 3px solid var(--accent);
            position: relative;
            overflow: hidden;
        }
        
        .hidden-word-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .question-display {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.2rem, 2.2vw, 1.5rem);
            border: 2px solid rgba(253, 187, 45, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .question-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .current-word {
            font-size: clamp(1rem, 1.8vw, 1.2rem);
            color: var(--accent);
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .question-text {
            font-size: clamp(1.2rem, 2.2vw, 1.5rem);
            color: var(--light);
            line-height: 1.4;
        }
        
        .intesa-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .intesa-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--info), #2980b9);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            font-size: clamp(1rem, 1.8vw, 1.1rem);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .intesa-btn:hover {
            background: linear-gradient(135deg, #2980b9, #21618c);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .intesa-btn:disabled {
            background: linear-gradient(135deg, #7f8c8d, #6c7a7d);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .intesa-buzzer {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            padding: 15px 30px;
            font-size: clamp(1.1rem, 2.2vw, 1.3rem);
        }
        
        .intesa-buzzer:hover {
            background: linear-gradient(135deg, #c0392b, #a93226);
        }
        
        .double-btn {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        
        .double-btn:hover {
            background: linear-gradient(135deg, #8e44ad, #7d3c98);
        }
        
        .pass-btn {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
        }
        
        .pass-btn:hover {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .intesa-stats {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            gap: 15px;
        }
        
        .intesa-stat {
            flex: 1;
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid rgba(253, 187, 45, 0.3);
        }
        
        .stat-value {
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: bold;
            color: var(--accent);
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: clamp(0.9rem, 1.6vw, 1rem);
            color: var(--light);
        }
        
        .player-roles {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            gap: 15px;
        }
        
        .player-role {
            flex: 1;
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid rgba(253, 187, 45, 0.3);
        }
        
        .role-name {
            font-size: clamp(1rem, 1.8vw, 1.2rem);
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 8px;
        }
        
        .role-player {
            font-size: clamp(0.9rem, 1.6vw, 1rem);
            color: var(--light);
        }
        
        .intesa-bonus {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.3), rgba(39, 174, 96, 0.2));
            border-radius: 12px;
            border: 2px solid var(--success);
            font-size: clamp(1.1rem, 2vw, 1.3rem);
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        .intesa-bonus::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .intesa-final {
            text-align: center;
            margin: 20px 0;
            padding: 25px;
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.3), rgba(142, 68, 173, 0.2));
            border-radius: 15px;
            border: 3px solid #9b59b6;
            position: relative;
            overflow: hidden;
        }
        
        .intesa-final::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wMyIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            z-index: -1;
        }
        
        .champion-crown {
            font-size: 3rem;
            color: var(--accent);
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }
        
        /* MIGLIORAMENTI PER SCHERMI MOLTO PICCOLI */
        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 15px;
                border-radius: 15px;
            }
            
            .letter-box {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .team-input {
                padding: 15px;
            }
            
            .quartina-container {
                padding: 15px;
            }
            
            .quartina-line {
                padding: 12px;
                min-height: 50px;
            }
            
            .player-buzzers {
                flex-direction: column;
            }
            
            .chain-direction {
                flex-direction: column;
                gap: 10px;
            }
            
            .zip-options {
                flex-direction: column;
                gap: 10px;
            }
            
            button {
                padding: 10px 15px;
            }
            
            .intesa-stats, .player-roles {
                flex-direction: column;
            }
            
            .intesa-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .intesa-btn {
                width: 100%;
                max-width: 250px;
            }
        }

        /* NUOVI STILI PER LA SELEZIONE SQUADRE */
        .player-selection {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }
        
        .player-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .player-input input {
            flex: 1;
        }
        
        .add-player-btn {
            background: linear-gradient(135deg, var(--info), #2980b9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.2rem;
        }
        
        .add-player-btn:hover {
            background: linear-gradient(135deg, #2980b9, #21618c);
            transform: scale(1.1);
        }
        
        .remove-player-btn {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }
        
        .remove-player-btn:hover {
            background: linear-gradient(135deg, #c0392b, #a93226);
            transform: scale(1.1);
        }
        
        .player-list {
            margin-top: 10px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border: 1px solid rgba(253, 187, 45, 0.3);
        }
        
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin-bottom: 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
        
        .player-item:last-child {
            margin-bottom: 0;
        }
        
        .player-name-display {
            font-size: 0.9rem;
        }
        
        /* Stili per l'animazione del punteggio */
        @keyframes scorePop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        .score-pop {
            animation: scorePop 0.5s ease-in-out;
        }
        
        /* Stili per il logo del gioco */
        .game-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            color: var(--accent);
            text-shadow: 0 0 10px rgba(253, 187, 45, 0.7);
        }
        
        /* Stili per le icone nei pulsanti */
        .btn-icon {
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <!-- Schermata di caricamento -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner"></div>
        <h2>Caricamento in corso...</h2>
    </div>
    
    <!-- Sigla del gioco - MODIFICATA PER ESSERE A TUTTO SCHERMO -->
    <div class="intro-overlay hidden" id="introOverlay">
        <video class="intro-video" id="introVideo" preload="auto">
            <source src="Sigla _Reazione a Catena_ 2024 (03-06-2024).mp4" type="video/mp4">
            Il tuo browser non supporta il video.
        </video>
        <button class="play-intro-btn" id="playIntroBtn"><i class="fas fa-play btn-icon"></i> RIPRODUCI SIGLA</button>
    </div>
    
    <!-- Timer musica (nascosto inizialmente) -->
    <div class="music-timer hidden" id="musicTimer"><i class="fas fa-music"></i> <span id="musicTimeLeft">20</span>s</div>

    <!-- Schermata di setup -->
    <div class="container hidden" id="setupScreen">
        <header>
            <div class="game-logo">
                <i class="fas fa-graduation-cap logo-icon"></i>
                <h1>Laureata a Catena</h1>
                <i class="fas fa-link logo-icon"></i>
            </div>
            <h2>Pi√π difficile della tesi (ma pi√π divertente)</h2>
        </header>
        
        <div class="setup-screen">
            <div class="team-setup">
                <div class="team-input">
                    <h3><i class="fas fa-users"></i> Squadra A</h3>
                    <input type="text" id="teamAName" placeholder="Nome Squadra A" value="Squadra A">
                    <div class="player-selection">
                        <div class="player-input">
                            <input type="text" id="teamAPlayerInput" placeholder="Nome giocatore">
                            <button class="add-player-btn" id="addTeamAPlayer"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="player-list" id="teamAPlayerList">
                            <!-- Lista giocatori squadra A -->
                        </div>
                    </div>
                </div>
                
                <div class="team-input">
                    <h3><i class="fas fa-users"></i> Squadra B</h3>
                    <input type="text" id="teamBName" placeholder="Nome Squadra B" value="Squadra B">
                    <div class="player-selection">
                        <div class="player-input">
                            <input type="text" id="teamBPlayerInput" placeholder="Nome giocatore">
                            <button class="add-player-btn" id="addTeamBPlayer"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="player-list" id="teamBPlayerList">
                            <!-- Lista giocatori squadra B -->
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="start-btn" id="startGameBtn" style="font-size: clamp(1.2rem, 2.2vw, 1.4rem); padding: 15px 30px; margin-top: 20px;">
                <i class="fas fa-play-circle btn-icon"></i> INIZIA IL GIOCO
            </button>
        </div>
    </div>
    
    <!-- Schermata di gioco principale (Caccia alla Parola) -->
    <div class="container hidden" id="gameScreen">
        <header>
            <div class="game-logo">
                <i class="fas fa-graduation-cap logo-icon"></i>
                <h1>Laureata a Catena</h1>
                <i class="fas fa-link logo-icon"></i>
            </div>
            <div class="game-mode" id="gameMode"><i class="fas fa-search"></i> Indovina la Parola</div>
        </header>
        
        <div class="game-info">
            <div class="team team-a" id="teamAElement">
                <div class="team-name" id="displayTeamA">Squadra A</div>
                <div class="score" id="scoreA">0</div>
            </div>
            <div class="team" id="teamBElement">
                <div class="team-name" id="displayTeamB">Squadra B</div>
                <div class="score" id="scoreB">0</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="word-grid" id="wordGrid">
                <!-- Le lettere verranno aggiunte qui dinamicamente -->
            </div>
            
            <div class="round-info" id="roundInfo"><i class="fas fa-pencil-alt"></i> Parola: 1/12</div>
            
            <div class="message" id="message">Premi "INIZIA" per cominciare il gioco!</div>
            
            <div class="controls">
                <button class="start-btn" id="startBtn"><i class="fas fa-rocket btn-icon"></i> INIZIA</button>
                <button class="buzzer" id="buzzer"><i class="fas fa-fire btn-icon"></i> BUZZER</button>
                <button class="next-btn" id="nextBtn"><i class="fas fa-forward btn-icon"></i> PROSSIMA</button>
            </div>
            
            <div class="answer-controls hidden" id="answerControls">
                <div class="player-name" id="answeringPlayer"></div>
                <div style="display: flex; gap: 12px;">
                    <button class="correct-btn" id="correctBtn"><i class="fas fa-check btn-icon"></i> ESATTA</button>
                    <button class="wrong-btn" id="wrongBtn"><i class="fas fa-times btn-icon"></i> ERRATA</button>
                </div>
            </div>
            
            <div class="game-completed hidden" id="gameCompleted">
                <h2><i class="fas fa-trophy"></i> Gioco Completato!</h2>
                <p style="font-size: clamp(1rem, 2vw, 1.2rem); margin: 12px 0;">Hai completato tutte le 12 parole di Reazione a Catena</p>
                <button class="next-game-btn" id="nextGameBtn"><i class="fas fa-gamepad btn-icon"></i> Prossimo Gioco: Quando, Dove, Come, Perch√© ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- Schermata del secondo gioco (Quando, Dove, Come, Perch√©) -->
    <div class="container hidden" id="secondGameScreen">
        <header>
            <div class="game-logo">
                <i class="fas fa-graduation-cap logo-icon"></i>
                <h1>Laureata a Catena</h1>
                <i class="fas fa-link logo-icon"></i>
            </div>
            <div class="game-mode" id="secondGameMode"><i class="fas fa-question-circle"></i> Quando, Dove, Come eeeee Perch√©</div>
        </header>
        
        <div class="game-info">
            <div class="team team-a" id="secondTeamAElement">
                <div class="team-name" id="secondDisplayTeamA">Squadra A</div>
                <div class="score" id="secondScoreA">0</div>
            </div>
            <div class="team" id="secondTeamBElement">
                <div class="team-name" id="secondDisplayTeamB">Squadra B</div>
                <div class="score" id="secondScoreB">0</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="quartina-container">
                <div class="quartina-line" id="quandoLine">
                    <span id="quandoText"><i class="fas fa-clock"></i> (Quando)</span>
                </div>
                <div class="quartina-line" id="doveLine">
                    <span id="doveText"><i class="fas fa-map-marker-alt"></i> (Dove)</span>
                </div>
                <div class="quartina-line" id="comeLine">
                    <span id="comeText"><i class="fas fa-theater-masks"></i> (Come)</span>
                </div>
                <div class="quartina-line" id="percheLine">
                    <span id="percheText"><i class="fas fa-question"></i> (Perch√©)</span>
                </div>
            </div>
            
            <div class="round-info" id="secondRoundInfo"><i class="fas fa-clipboard-list"></i> Quartina: 1/4</div>
            
            <div class="quartina-points" id="quartinaPoints">
                <i class="fas fa-trophy"></i> Punti possibili: <span id="pointsValue">20</span>
            </div>
            
            <div class="message" id="secondMessage">Premi "INIZIA QUARTINA" per iniziare il gioco!</div>
            
            <div class="player-buzzers" id="secondPlayerBuzzers">
                <div class="team-buzzers">
                    <button class="player-buzzer" id="secondBuzzerA"><i class="fas fa-users"></i> BUZZER</button>
                </div>
                <div class="team-buzzers">
                    <button class="player-buzzer" id="secondBuzzerB"><i class="fas fa-users"></i> BUZZER</button>
                </div>
            </div>
            
            <div class="controls">
                <button class="start-btn" id="secondStartBtn"><i class="fas fa-rocket btn-icon"></i> INIZIA QUARTINA</button>
                <button class="next-btn" id="secondNextBtn"><i class="fas fa-forward btn-icon"></i> PROSSIMA AFFERMAZIONE</button>
                <button class="next-btn" id="secondNextQuartinaBtn"><i class="fas fa-clipboard-list btn-icon"></i> PROSSIMA QUARTINA</button>
            </div>
            
            <div class="answer-controls hidden" id="secondAnswerControls">
                <div class="player-name" id="secondAnsweringPlayer"></div>
                <div style="display: flex; gap: 12px;">
                    <button class="correct-btn" id="secondCorrectBtn"><i class="fas fa-check btn-icon"></i> ESATTA</button>
                    <button class="wrong-btn" id="secondWrongBtn"><i class="fas fa-times btn-icon"></i> ERRATA</button>
                </div>
            </div>
            
            <div class="correct-answer hidden" id="correctAnswerDisplay">
                <strong><i class="fas fa-bullseye"></i> Risposta corretta:</strong> <span id="correctAnswerText"></span>
            </div>
            
            <div class="game-completed hidden" id="secondGameCompleted">
                <h2><i class="fas fa-trophy"></i> Gioco Completato!</h2>
                <p style="font-size: clamp(1rem, 2vw, 1.2rem); margin: 12px 0;">Hai completato tutte le 4 quartine di Reazione a Catena</p>
                <button class="next-game-btn" id="secondNextGameBtn"><i class="fas fa-gamepad btn-icon"></i> Prossimo Gioco: Una tira l'altra ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- Schermata del terzo gioco (Una tira l'altra) -->
    <div class="container hidden" id="thirdGameScreen">
        <header>
            <div class="game-logo">
                <i class="fas fa-graduation-cap logo-icon"></i>
                <h1>Laureata a Catena</h1>
                <i class="fas fa-link logo-icon"></i>
            </div>
            <div class="game-mode" id="thirdGameMode"><i class="fas fa-bullseye"></i> Una tira l'altra</div>
        </header>
        
        <div class="game-info">
            <div class="team team-a" id="thirdTeamAElement">
                <div class="team-name" id="thirdDisplayTeamA">Squadra A</div>
                <div class="score" id="thirdScoreA">0</div>
            </div>
            <div class="team" id="thirdTeamBElement">
                <div class="team-name" id="thirdDisplayTeamB">Squadra B</div>
                <div class="score" id="thirdScoreB">0</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="chain-container" id="chainContainer">
                <!-- Le parole della catena verranno aggiunte qui dinamicamente -->
            </div>
            
            <div class="round-info" id="thirdRoundInfo"><i class="fas fa-link"></i> Catena: 1/2</div>
            
            <div class="message" id="thirdMessage"><i class="fas fa-bullseye"></i> Scegli da che direzione iniziare la catena!</div>
            
            <div class="chain-direction" id="chainDirection">
                <button class="direction-btn" id="topDirectionBtn"><i class="fas fa-arrow-down"></i> Dall'alto</button>
                <button class="direction-btn" id="bottomDirectionBtn"><i class="fas fa-arrow-up"></i> Dal basso</button>
            </div>
            
            <div class="controls">
                <button class="start-btn" id="thirdStartBtn"><i class="fas fa-rocket btn-icon"></i> INIZIA CATENA</button>
                <button class="buzzer" id="thirdBuzzer"><i class="fas fa-fire btn-icon"></i> BUZZER</button>
                <button class="next-btn" id="thirdNextBtn"><i class="fas fa-forward btn-icon"></i> PROSSIMA CATENA</button>
            </div>
            
            <div class="answer-controls hidden" id="thirdAnswerControls">
                <div class="player-name" id="thirdAnsweringPlayer"></div>
                <div style="display: flex; gap: 12px;">
                    <button class="correct-btn" id="thirdCorrectBtn"><i class="fas fa-check btn-icon"></i> ESATTA</button>
                    <button class="wrong-btn" id="thirdWrongBtn"><i class="fas fa-times btn-icon"></i> ERRATA</button>
                </div>
            </div>
            
            <!-- Opzioni per cambiare direzione -->
            <div class="chain-direction hidden" id="directionOptions">
                <button class="direction-btn" id="continueDirectionBtn"><i class="fas fa-redo btn-icon"></i> Continua</button>
                <button class="direction-btn" id="changeDirectionBtn"><i class="fas fa-exchange-alt btn-icon"></i> Cambia direzione</button>
            </div>
            
            <!-- ZIP Game -->
            <div class="zip-container hidden" id="zipContainer">
                <h2 style="text-align: center; margin-bottom: 15px;"><i class="fas fa-bullseye"></i> GIOCO DELLA ZIP</h2>
                
                <div class="chain-container">
                    <div class="chain-word revealed" id="zipFirstWord">
                        BANCO
                    </div>
                    <div class="chain-word hidden-word" id="zipSecondWord">
                        D__I
                    </div>
                    <div class="chain-word hidden-word" id="zipThirdWord">
                        C___O
                    </div>
                    <div class="chain-word revealed" id="zipFourthWord">
                        BATTAGLIA
                    </div>
                </div>
                
                <div class="zip-prize" id="zipPrize">
                    <i class="fas fa-trophy"></i> Premio in palio: <span id="prizeValue">50</span> punti!
                </div>

                <div class="zip-timer hidden" id="zipTimer">
                    <i class="fas fa-clock"></i> Tempo rimanente: <span id="zipTimeLeft">10</span> secondi
                </div>
                
                <div class="message" id="zipMessage">
                    <i class="fas fa-bullseye"></i> Hai completato la catena! Vuoi giocare la ZIP o passare la mano?
                </div>
                
                <div class="zip-options" id="zipOptions">
                    <button class="zip-btn" id="playZipBtn"><i class="fas fa-gamepad btn-icon"></i> GIOCA LA ZIP</button>
                    <button class="zip-btn" id="passZipBtn"><i class="fas fa-redo btn-icon"></i> PASSA LA MANO</button>
                </div>
                
                <div class="answer-controls hidden" id="zipAnswerControls">
                    <div class="player-name" id="zipAnsweringPlayer"></div>
                    <div style="display: flex; gap: 12px;">
                        <button class="correct-btn" id="zipCorrectBtn"><i class="fas fa-check btn-icon"></i> ESATTA</button>
                        <button class="wrong-btn" id="zipWrongBtn"><i class="fas fa-times btn-icon"></i> ERRATA</button>
                    </div>
                </div>
                
                <div class="correct-answer hidden" id="zipCorrectAnswer">
                    <strong><i class="fas fa-bullseye"></i> Risposta corretta:</strong> <span id="zipAnswerText">BANCO DATI CAMPO BATTAGLIA</span>
                </div>
            </div>
            
            <div class="game-completed hidden" id="thirdGameCompleted">
                <h2><i class="fas fa-trophy"></i> Gioco Completato!</h2>
                <p style="font-size: clamp(1rem, 2vw, 1.2rem); margin: 12px 0;">Hai completato tutte le catene di "Una tira l'altra"</p>
                <button class="next-game-btn" id="thirdNextGameBtn"><i class="fas fa-handshake btn-icon"></i> Vai all'Intesa Vincente ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- Schermata del quarto gioco (L'Intesa Vincente) -->
    <div class="container hidden" id="fourthGameScreen">
        <header>
            <div class="game-logo">
                <i class="fas fa-graduation-cap logo-icon"></i>
                <h1>Laureata a Catena</h1>
                <i class="fas fa-link logo-icon"></i>
            </div>
            <div class="game-mode" id="fourthGameMode"><i class="fas fa-handshake"></i> L'Intesa Vincente</div>
        </header>
        
        <div class="game-info">
            <div class="team team-a" id="fourthTeamAElement">
                <div class="team-name" id="fourthDisplayTeamA">Squadra A</div>
                <div class="score" id="fourthScoreA">0</div>
            </div>
            <div class="team" id="fourthTeamBElement">
                <div class="team-name" id="fourthDisplayTeamB">Squadra B</div>
                <div class="score" id="fourthScoreB">0</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="intesa-bonus" id="intesaBonus">
                <i class="fas fa-clock"></i> Bonus ZIP: <span id="zipBonusTime">5</span> secondi extra per la squadra che ha vinto la ZIP!
            </div>
            
            <div class="intesa-container">
                <div class="intesa-timer" id="intesaTimer">
                    <i class="fas fa-stopwatch"></i> Tempo rimanente: <span id="intesaTimeLeft">60</span> secondi
                </div>
                
                <div class="hidden-word-display" id="hiddenWordDisplay">
                    <span id="hiddenWordText">PAROLA NASCOSTA</span>
                </div>
                
                <div class="question-display" id="questionDisplay">
                    <div class="current-word" id="currentWordIndicator">Parola corrente: <span id="currentWordNumber">1</span></div>
                    <div class="question-text" id="questionText">I suggeritori iniziano a formulare la domanda...</div>
                </div>
                
                <div class="intesa-stats">
                    <div class="intesa-stat">
                        <div class="stat-label">Parole indovinate</div>
                        <div class="stat-value" id="wordsGuessedA">0</div>
                    </div>
                    <div class="intesa-stat">
                        <div class="stat-label">Passi rimanenti</div>
                        <div class="stat-value" id="passesRemaining">3</div>
                    </div>
                    <div class="intesa-stat">
                        <div class="stat-label">Raddoppi rimanenti</div>
                        <div class="stat-value" id="doublesRemaining">2</div>
                    </div>
                    <div class="intesa-stat">
                        <div class="stat-label">Parole indovinate</div>
                        <div class="stat-value" id="wordsGuessedB">0</div>
                    </div>
                </div>
                
                <div class="player-roles">
                    <div class="player-role">
                        <div class="role-name">Suggeritore 1</div>
                        <div class="role-player" id="suggeritore1A">Giocatore A1</div>
                    </div>
                    <div class="player-role">
                        <div class="role-name">Suggeritore 2</div>
                        <div class="role-player" id="suggeritore2A">Giocatore A2</div>
                    </div>
                    <div class="player-role">
                        <div class="role-name">Indovino</div>
                        <div class="role-player" id="indovinoA">Giocatore A3</div>
                    </div>
                    <div class="player-role">
                        <div class="role-name">Indovino</div>
                        <div class="role-player" id="indovinoB">Giocatore B3</div>
                    </div>
                    <div class="player-role">
                        <div class="role-name">Suggeritore 2</div>
                        <div class="role-player" id="suggeritore2B">Giocatore B2</div>
                    </div>
                    <div class="player-role">
                        <div class="role-name">Suggeritore 1</div>
                        <div class="role-player" id="suggeritore1B">Giocatore B1</div>
                    </div>
                </div>
                
                <div class="message" id="fourthMessage">
                    <i class="fas fa-info-circle"></i> Inizia la squadra con il montepremi pi√π basso. Premi "INIZIA MANCHE" per cominciare!
                </div>
                
                <div class="intesa-controls">
                    <button class="intesa-btn" id="fourthStartBtn"><i class="fas fa-rocket btn-icon"></i> INIZIA MANCHE</button>
                    <button class="intesa-btn intesa-buzzer" id="fourthBuzzer"><i class="fas fa-bullhorn btn-icon"></i> BUZZER</button>
                    <button class="intesa-btn pass-btn" id="passBtn"><i class="fas fa-forward btn-icon"></i> PASSA (<span id="passCount">3</span>)</button>
                    <button class="intesa-btn double-btn" id="doubleBtn"><i class="fas fa-retweet btn-icon"></i> RADDOPPIO (<span id="doubleCount">2</span>)</button>
                </div>
                
                <div class="answer-controls hidden" id="fourthAnswerControls">
                    <div class="player-name" id="fourthAnsweringPlayer"></div>
                    <div style="display: flex; gap: 12px;">
                        <button class="correct-btn" id="fourthCorrectBtn"><i class="fas fa-check btn-icon"></i> ESATTA</button>
                        <button class="wrong-btn" id="fourthWrongBtn"><i class="fas fa-times btn-icon"></i> ERRATA</button>
                    </div>
                </div>
                
                <div class="correct-answer hidden" id="fourthCorrectAnswer">
                    <strong><i class="fas fa-bullseye"></i> Risposta corretta:</strong> <span id="fourthAnswerText"></span>
                </div>
            </div>
            
            <div class="intesa-final hidden" id="intesaFinal">
                <div class="champion-crown"><i class="fas fa-crown"></i></div>
                <h2><i class="fas fa-trophy"></i> CAMPIONE DELLA PUNTATA!</h2>
                <p style="font-size: clamp(1rem, 2vw, 1.2rem); margin: 12px 0;">La <span id="championTeam">Squadra A</span> si laurea campione!</p>
                <p style="font-size: clamp(0.9rem, 1.8vw, 1.1rem); margin: 8px 0;">Bonus: <span id="finalBonus">1000</span>‚Ç¨ + <span id="wordBonus">0</span>‚Ç¨ per le parole indovinate</p>
                <button class="next-game-btn" id="fourthNextGameBtn"><i class="fas fa-home btn-icon"></i> Torna al Menu Principale</button>
            </div>
        </div>
    </div>

    <!-- Elemento audio nascosto per la canzone -->
    <audio id="introMusic" preload="auto">
        <source src="intro-music.mp3" type="audio/mp3">
        Il tuo browser non supporta l'elemento audio.
    </audio>

    <script>
        // Elementi DOM per la sigla
        const loadingScreen = document.getElementById('loadingScreen');
        const introOverlay = document.getElementById('introOverlay');
        const introVideo = document.getElementById('introVideo');
        const playIntroBtn = document.getElementById('playIntroBtn');
        
        // Funzione per mostrare la sigla
        function showIntro() {
            // Nascondi la schermata di caricamento
            loadingScreen.classList.add('hidden');
            
            // Mostra la sigla
            introOverlay.classList.remove('hidden');
        }
        
        // Funzione per saltare la sigla
        function skipIntro() {
            introOverlay.classList.add('hidden');
            setupScreen.classList.remove('hidden');
        }
        
        // Event listener per il pulsante "Riproduci sigla"
        playIntroBtn.addEventListener('click', () => {
            introVideo.play();
            playIntroBtn.style.display = 'none';
        });
        
        // Quando il video finisce, passa al setup
        introVideo.addEventListener('ended', () => {
            skipIntro();
        });
        
        // Inizializzazione del gioco
        window.addEventListener('load', () => {
            // Simula un tempo di caricamento
            setTimeout(() => {
                showIntro();
            }, 1500);
        });

        // Array per memorizzare i giocatori di ogni squadra
        let teamAPlayers = [];
        let teamBPlayers = [];
        
        // Elementi DOM per la gestione dei giocatori
        const teamAPlayerInput = document.getElementById('teamAPlayerInput');
        const teamBPlayerInput = document.getElementById('teamBPlayerInput');
        const addTeamAPlayerBtn = document.getElementById('addTeamAPlayer');
        const addTeamBPlayerBtn = document.getElementById('addTeamBPlayer');
        const teamAPlayerList = document.getElementById('teamAPlayerList');
        const teamBPlayerList = document.getElementById('teamBPlayerList');
        
        // Funzione per aggiungere un giocatore alla squadra A
        function addTeamAPlayer() {
            const playerName = teamAPlayerInput.value.trim();
            if (playerName && teamAPlayers.length < 6) {
                teamAPlayers.push(playerName);
                updatePlayerList('A');
                teamAPlayerInput.value = '';
            }
        }
        
        // Funzione per aggiungere un giocatore alla squadra B
        function addTeamBPlayer() {
            const playerName = teamBPlayerInput.value.trim();
            if (playerName && teamBPlayers.length < 6) {
                teamBPlayers.push(playerName);
                updatePlayerList('B');
                teamBPlayerInput.value = '';
            }
        }
        
        // Funzione per rimuovere un giocatore
        function removePlayer(team, index) {
            if (team === 'A') {
                teamAPlayers.splice(index, 1);
                updatePlayerList('A');
            } else {
                teamBPlayers.splice(index, 1);
                updatePlayerList('B');
            }
        }
        
        // Funzione per aggiornare la lista dei giocatori
        function updatePlayerList(team) {
            const playerList = team === 'A' ? teamAPlayerList : teamBPlayerList;
            const players = team === 'A' ? teamAPlayers : teamBPlayers;
            
            playerList.innerHTML = '';
            
            players.forEach((player, index) => {
                const playerItem = document.createElement('div');
                playerItem.className = 'player-item';
                
                const playerName = document.createElement('span');
                playerName.className = 'player-name-display';
                playerName.textContent = player;
                
                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-player-btn';
                removeBtn.innerHTML = '<i class="fas fa-times"></i>';
                removeBtn.onclick = () => removePlayer(team, index);
                
                playerItem.appendChild(playerName);
                playerItem.appendChild(removeBtn);
                playerList.appendChild(playerItem);
            });
        }
        
        // Event listeners per i pulsanti di aggiunta giocatori
        addTeamAPlayerBtn.addEventListener('click', addTeamAPlayer);
        addTeamBPlayerBtn.addEventListener('click', addTeamBPlayer);
        
        // Permetti di aggiungere giocatori premendo Enter
        teamAPlayerInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTeamAPlayer();
            }
        });
        
        teamBPlayerInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTeamBPlayer();
            }
        });
        
        // Variabili di gioco per Caccia alla Parola
        let currentWord = '';
        let revealedLetters = [];
        let currentLetterIndex = 0;
        let letterInterval;
        let gameStarted = false;
        let currentRound = 1;
        let totalRounds = 12;
        let scoreA = 0;
        let scoreB = 0;
        let currentTeam = 'A';
        let answeringPlayer = '';
        let musicPlayed = false; // Variabile per controllare se la musica √® gi√† stata riprodotta
        
        // Lista di parole LUNGHE e complesse (sempre nello stesso ordine)
        const wordList = [
            'AUTOMOBILE', 'TELEVISIONE', 'COMPUTER', 'BIBLIOTECA', 'GIARDINO',
            'ELEFANTE', 'CANGURO', 'DINOSAURO', 'AEROPORTO', 'UNIVERSIT√Ä',
            'RISTORANTE', 'OSPEDALE'
        ];
        
        // Variabili di gioco per Quando, Dove, Come, Perch√©
        let secondGameStarted = false;
        let secondCurrentRound = 1;
        let secondTotalRounds = 4;
        let currentQuartinaStep = 0;
        let currentAnsweringPlayer = '';
        let currentAnsweringTeam = '';
        let quartinaPoints = 20;
        let musicTimeout;
        let musicTimerInterval;
        
        // Lista di quartine (Quando, Dove, Come, Perch√©, Risposta)
        const quartineList = [
            {
                quando: "La notte di Natale...",
                dove: "... attorno a un tavolo...",
                come: "... con dei fagioli in mano...",
                perche: "... per fare cinquina!",
                risposta: "TOMBOLA"
            },
            {
                quando: "Nel 1969...",
                dove: "... sulla Luna...",
                come: "... con un piccolo passo...",
                perche: "... per l'umanit√†!",
                risposta: "ALLUNAGGIO"
            },
            {
                quando: "Nel Rinascimento...",
                dove: "... a Firenze...",
                come: "... con genio e creativit√†...",
                perche: "... per dare vita a capolavori!",
                risposta: "LEONARDO DA VINCI"
            },
            {
                quando: "Ogni quattro anni...",
                dove: "... in tutto il mondo...",
                come: "... con atleti e bandiere...",
                perche: "... per l'onore della propria nazione!",
                risposta: "OLIMPIADI"
            }
        ];
        
        // Variabili di gioco per Una tira l'altra
        let thirdGameStarted = false;
        let thirdCurrentRound = 1;
        let thirdTotalRounds = 2;
        let currentChainDirection = ''; // 'top' o 'bottom'
        let currentChainPosition = 0;
        let currentHiddenWordIndex = 0;
        let zipGameActive = false;
        let zipPlayingTeam = '';
        let revealedLettersPerWord = []; // Tiene traccia delle lettere rivelate per ogni parola
        let currentRevealedLetters = []; // Lettere rivelate per la parola corrente
        let zipTimerInterval;
        let zipTimeLeft = 10;
        
        // Lista di catene per Una tira l'altra (7 parole per catena) - SOLO LA SECONDA CATENA HA LA ZIP
        const chainList = [
            {
                words: ["CARNEVALE", "SAMBA", "COPACABANA", "CAIPIRINHA", "AMAZZONIA", "PALME", "OCEANO"],
                zip: null // Prima catena senza ZIP
            },
            {
                words: ["CAFF√à", "ZUCCHERO", "PIANTAGIONE", "COLONIALISMO", "NAVI", "EUROPA", "MERCATO"],
                zip: {
                    first: "BANCO",
                    second: "DATI", // Seconda parola
                    third: "CAMPO",  // Terza parola
                    fourth: "BATTAGLIA",
                    answer: "BANCO DATI CAMPO BATTAGLIA"
                }
            }
        ];
        
        // Variabili di gioco per L'Intesa Vincente
        let fourthGameStarted = false;
        let currentPlayingTeam = ''; // 'A' o 'B'
        let currentWordIndex = 0;
        let wordsGuessedA = 0;
        let wordsGuessedB = 0;
        let passesRemaining = 3;
        let doublesRemaining = 2;
        let intesaTimerInterval;
        let intesaTimeLeft = 60;
        let zipBonusTime = 5; // 5 secondi extra dalla ZIP
        let currentQuestion = '';
        let currentHiddenWord = '';
        let isDoubleRound = false;
        let currentSuggeritoreIndex = 0; // Alterna tra i due suggeritori
        
        // Lista di parole per L'Intesa Vincente
        const intesaWords = [
"FORESTA", "VIAGGIO", "CITT√Ä", "ROMANZO", "AUTORE",
"STRADA", "MONETA", "STAGIONE", "ESPLORATORE", "AVVENTURA",
"MONTAGNA", "FARO", "VELA", "MAESTRO", "ALLIEVO",
"DUELLO", "GIURIA", "PUNTEGGIO", "MISSIONE", "ORIGINE",
"CASTELLO", "OCEANO", "DRAGO", "TESORO", "LEGGENDA",
"PORTALE", "DESTINO", "NAVIGATORE", "TEMPESTA", "ISOLA",
"CONQUISTA", "PRIGIONE", "CORONA", "FANTASMA", "ENIGMA",
"TORRE", "MAGO", "BATTAGLIA", "INVENZIONE", "CAVALIERE",
"VIOLINO", "SOGNO", "TRAMONTO", "MARE", "RICORDO",
"FESTA", "SEGRETO", "PROMESSA", "SCOPERTA", "MISTERO"
        ];
        
        // Lista di parole per i raddoppi (locuzioni o gruppi di parole)
        const doubleWords = [
           "PRIMA GUERRA", "ACQUA MINERALE", "STELLA POLARE", "CAMPO DA CALCIO", "PONTE LEVATOIO",
           "FUOCO ARTIFICIALE", "LUCE SOLARE", "VENTO GELIDO", "PIANTA GRASSA", "LUNA PIENA",
            "CUORE SPEZZATO", "CANE RANDAGIO", "CAVALLO MARINO", "TERRA PROMESSA", "FIORE D‚ÄôARANCIO",
            "NOTTE FONDA", "TEMPO LIBERO", "VIA LATTEA", "PORTO SICURO", "STRADA MAESTRA",
           "TRENO REGIONALE", "PUNTO DEBOLE", "ARCOBALENO ARTICO", "FOGLIA SECCA", "SOLE NASCENTE",
           "FONTE SEGRETA", "CASA VACANZE", "FAME NERA", "CAMPO MINATO", "FILO SPINATO",
            "FERRO BATTUTO", "ALBERO GENEALOGICO", "SOGNO RICORRENTE", "PESO MASSIMO", "LAGO ARTIFICIALE",
          "PAROLA CHIAVE", "NAVE PIRATA", "TEMPO LIMITE", "OCCHIO DI BUE", "PORTA PRINCIPALE",
           "VENTO DI TRAMONTANA", "ANELLO NUZIALE", "MONETA D‚ÄôORO", "FESTA PATRONALE", "GIOCO DI RUOLO",
          "VIAGGIO DI NOZZE", "FACCIA NASCOSTA", "ACQUA ALTA", "FUOCO LENTO", "PUNTO DI PARTENZA"

        ];
        
        // Elementi DOM
        const setupScreen = document.getElementById('setupScreen');
        const gameScreen = document.getElementById('gameScreen');
        const secondGameScreen = document.getElementById('secondGameScreen');
        const thirdGameScreen = document.getElementById('thirdGameScreen');
        const fourthGameScreen = document.getElementById('fourthGameScreen');
        const wordGrid = document.getElementById('wordGrid');
        const message = document.getElementById('message');
        const startBtn = document.getElementById('startBtn');
        const buzzer = document.getElementById('buzzer');
        const nextBtn = document.getElementById('nextBtn');
        const scoreAElement = document.getElementById('scoreA');
        const scoreBElement = document.getElementById('scoreB');
        const roundInfoElement = document.getElementById('roundInfo');
        const startGameBtn = document.getElementById('startGameBtn');
        const answerControls = document.getElementById('answerControls');
        const correctBtn = document.getElementById('correctBtn');
        const wrongBtn = document.getElementById('wrongBtn');
        const answeringPlayerElement = document.getElementById('answeringPlayer');
        const gameCompleted = document.getElementById('gameCompleted');
        const nextGameBtn = document.getElementById('nextGameBtn');
        const teamAElement = document.getElementById('teamAElement');
        const teamBElement = document.getElementById('teamBElement');
        
        // Elementi per i nomi delle squadre
        const teamANameInput = document.getElementById('teamAName');
        const teamBNameInput = document.getElementById('teamBName');
        
        const displayTeamA = document.getElementById('displayTeamA');
        const displayTeamB = document.getElementById('displayTeamB');
        
        // Elementi DOM per Quando, Dove, Come, Perch√©
        const secondDisplayTeamA = document.getElementById('secondDisplayTeamA');
        const secondDisplayTeamB = document.getElementById('secondDisplayTeamB');
        const secondScoreA = document.getElementById('secondScoreA');
        const secondScoreB = document.getElementById('secondScoreB');
        const secondTeamAElement = document.getElementById('secondTeamAElement');
        const secondTeamBElement = document.getElementById('secondTeamBElement');
        const quandoLine = document.getElementById('quandoLine');
        const doveLine = document.getElementById('doveLine');
        const comeLine = document.getElementById('comeLine');
        const percheLine = document.getElementById('percheLine');
        const quandoText = document.getElementById('quandoText');
        const doveText = document.getElementById('doveText');
        const comeText = document.getElementById('comeText');
        const percheText = document.getElementById('percheText');
        const secondRoundInfo = document.getElementById('secondRoundInfo');
        const secondMessage = document.getElementById('secondMessage');
        const secondStartBtn = document.getElementById('secondStartBtn');
        const secondNextBtn = document.getElementById('secondNextBtn');
        const secondNextQuartinaBtn = document.getElementById('secondNextQuartinaBtn');
        const secondAnswerControls = document.getElementById('secondAnswerControls');
        const secondAnsweringPlayer = document.getElementById('secondAnsweringPlayer');
        const secondCorrectBtn = document.getElementById('secondCorrectBtn');
        const secondWrongBtn = document.getElementById('secondWrongBtn');
        const secondGameCompleted = document.getElementById('secondGameCompleted');
        const secondNextGameBtn = document.getElementById('secondNextGameBtn');
        const quartinaPointsElement = document.getElementById('quartinaPoints');
        const pointsValueElement = document.getElementById('pointsValue');
        const correctAnswerDisplay = document.getElementById('correctAnswerDisplay');
        const correctAnswerText = document.getElementById('correctAnswerText');
        const introMusic = document.getElementById('introMusic');
        const musicTimer = document.getElementById('musicTimer');
        const musicTimeLeftElement = document.getElementById('musicTimeLeft');
        const secondPlayerBuzzers = document.getElementById('secondPlayerBuzzers');
        const secondBuzzerA = document.getElementById('secondBuzzerA');
        const secondBuzzerB = document.getElementById('secondBuzzerB');
        
        // Elementi DOM per Una tira l'altra
        const thirdDisplayTeamA = document.getElementById('thirdDisplayTeamA');
        const thirdDisplayTeamB = document.getElementById('thirdDisplayTeamB');
        const thirdScoreA = document.getElementById('thirdScoreA');
        const thirdScoreB = document.getElementById('thirdScoreB');
        const thirdTeamAElement = document.getElementById('thirdTeamAElement');
        const thirdTeamBElement = document.getElementById('thirdTeamBElement');
        const chainContainer = document.getElementById('chainContainer');
        const thirdRoundInfo = document.getElementById('thirdRoundInfo');
        const thirdMessage = document.getElementById('thirdMessage');
        const topDirectionBtn = document.getElementById('topDirectionBtn');
        const bottomDirectionBtn = document.getElementById('bottomDirectionBtn');
        const thirdStartBtn = document.getElementById('thirdStartBtn');
        const thirdBuzzer = document.getElementById('thirdBuzzer');
        const thirdNextBtn = document.getElementById('thirdNextBtn');
        const thirdAnswerControls = document.getElementById('thirdAnswerControls');
        const thirdAnsweringPlayer = document.getElementById('thirdAnsweringPlayer');
        const thirdCorrectBtn = document.getElementById('thirdCorrectBtn');
        const thirdWrongBtn = document.getElementById('thirdWrongBtn');
        const thirdGameCompleted = document.getElementById('thirdGameCompleted');
        const thirdNextGameBtn = document.getElementById('thirdNextGameBtn');
        
        // Elementi DOM per ZIP
        const zipContainer = document.getElementById('zipContainer');
        const zipFirstWord = document.getElementById('zipFirstWord');
        const zipSecondWord = document.getElementById('zipSecondWord');
        const zipThirdWord = document.getElementById('zipThirdWord');
        const zipFourthWord = document.getElementById('zipFourthWord');
        const zipPrize = document.getElementById('zipPrize');
        const zipTimer = document.getElementById('zipTimer');
        const zipTimeLeftElement = document.getElementById('zipTimeLeft');
        const zipMessage = document.getElementById('zipMessage');
        const zipOptions = document.getElementById('zipOptions');
        const playZipBtn = document.getElementById('playZipBtn');
        const passZipBtn = document.getElementById('passZipBtn');
        const zipAnswerControls = document.getElementById('zipAnswerControls');
        const zipAnsweringPlayer = document.getElementById('zipAnsweringPlayer');
        const zipCorrectBtn = document.getElementById('zipCorrectBtn');
        const zipWrongBtn = document.getElementById('zipWrongBtn');
        const zipCorrectAnswer = document.getElementById('zipCorrectAnswer');
        const zipAnswerText = document.getElementById('zipAnswerText');
        const prizeValueElement = document.getElementById('prizeValue');
        
        // Elementi DOM per le opzioni di direzione
        const directionOptions = document.getElementById('directionOptions');
        const continueDirectionBtn = document.getElementById('continueDirectionBtn');
        const changeDirectionBtn = document.getElementById('changeDirectionBtn');
        
        // Elementi DOM per L'Intesa Vincente
        const fourthDisplayTeamA = document.getElementById('fourthDisplayTeamA');
        const fourthDisplayTeamB = document.getElementById('fourthDisplayTeamB');
        const fourthScoreA = document.getElementById('fourthScoreA');
        const fourthScoreB = document.getElementById('fourthScoreB');
        const fourthTeamAElement = document.getElementById('fourthTeamAElement');
        const fourthTeamBElement = document.getElementById('fourthTeamBElement');
        const intesaBonus = document.getElementById('intesaBonus');
        const zipBonusTimeElement = document.getElementById('zipBonusTime');
        const intesaTimer = document.getElementById('intesaTimer');
        const intesaTimeLeftElement = document.getElementById('intesaTimeLeft');
        const hiddenWordDisplay = document.getElementById('hiddenWordDisplay');
        const hiddenWordText = document.getElementById('hiddenWordText');
        const questionDisplay = document.getElementById('questionDisplay');
        const currentWordIndicator = document.getElementById('currentWordIndicator');
        const currentWordNumber = document.getElementById('currentWordNumber');
        const questionText = document.getElementById('questionText');
        const wordsGuessedAElement = document.getElementById('wordsGuessedA');
        const wordsGuessedBElement = document.getElementById('wordsGuessedB');
        const passesRemainingElement = document.getElementById('passesRemaining');
        const doublesRemainingElement = document.getElementById('doublesRemaining');
        const suggeritore1A = document.getElementById('suggeritore1A');
        const suggeritore2A = document.getElementById('suggeritore2A');
        const indovinoA = document.getElementById('indovinoA');
        const indovinoB = document.getElementById('indovinoB');
        const suggeritore2B = document.getElementById('suggeritore2B');
        const suggeritore1B = document.getElementById('suggeritore1B');
        const fourthMessage = document.getElementById('fourthMessage');
        const fourthStartBtn = document.getElementById('fourthStartBtn');
        const fourthBuzzer = document.getElementById('fourthBuzzer');
        const passBtn = document.getElementById('passBtn');
        const passCount = document.getElementById('passCount');
        const doubleBtn = document.getElementById('doubleBtn');
        const doubleCount = document.getElementById('doubleCount');
        const fourthAnswerControls = document.getElementById('fourthAnswerControls');
        const fourthAnsweringPlayer = document.getElementById('fourthAnsweringPlayer');
        const fourthCorrectBtn = document.getElementById('fourthCorrectBtn');
        const fourthWrongBtn = document.getElementById('fourthWrongBtn');
        const fourthCorrectAnswer = document.getElementById('fourthCorrectAnswer');
        const fourthAnswerText = document.getElementById('fourthAnswerText');
        const intesaFinal = document.getElementById('intesaFinal');
        const championTeam = document.getElementById('championTeam');
        const finalBonus = document.getElementById('finalBonus');
        const wordBonus = document.getElementById('wordBonus');
        const fourthNextGameBtn = document.getElementById('fourthNextGameBtn');
        
        // Aggiorna la visualizzazione delle squadre attive
        function updateActiveTeam() {
            if (currentTeam === 'A') {
                teamAElement.classList.add('active-team');
                teamBElement.classList.remove('active-team');
                secondTeamAElement.classList.add('active-team');
                secondTeamBElement.classList.remove('active-team');
                thirdTeamAElement.classList.add('active-team');
                thirdTeamBElement.classList.remove('active-team');
                fourthTeamAElement.classList.add('active-team');
                fourthTeamBElement.classList.remove('active-team');
            } else {
                teamBElement.classList.add('active-team');
                teamAElement.classList.remove('active-team');
                secondTeamBElement.classList.add('active-team');
                secondTeamAElement.classList.remove('active-team');
                thirdTeamBElement.classList.add('active-team');
                thirdTeamAElement.classList.remove('active-team');
                fourthTeamBElement.classList.add('active-team');
                fourthTeamAElement.classList.remove('active-team');
            }
        }
        
        // Inizializzazione del gioco Caccia alla Parola
        function initGame() {
            resetGame();
            updateScores();
            updateActiveTeam();
            roundInfoElement.textContent = `üìù Parola: ${currentRound}/${totalRounds}`;
            message.textContent = `üéØ Inizia la ${displayTeamA.textContent}!`;
            
            // NON riprodurre la musica qui - verr√† riprodotta solo quando inizia il primo gioco
        }
        
        // Reset del gioco Caccia alla Parola
        function resetGame() {
            clearInterval(letterInterval);
            gameStarted = false;
            revealedLetters = [];
            currentLetterIndex = 0;
            wordGrid.innerHTML = '';
            buzzer.disabled = true;
            nextBtn.disabled = true;
            answerControls.classList.add('hidden');
        }
        
        // Avvia il gioco Caccia alla Parola
        function startGame() {
            if (gameStarted) return;
            
            gameStarted = true;
            currentWord = wordList[currentRound - 1];
            createWordGrid();
            startRevealingLetters();
            message.textContent = `üîç Indovina la parola! Tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            buzzer.disabled = false;
            startBtn.disabled = true;
            nextBtn.disabled = true;
            
            // RIPRODUCI LA MUSICA SOLO QUI, quando inizia effettivamente il primo gioco E SOLO UNA VOLTA
            if (!musicPlayed) {
                playIntroMusic();
                musicPlayed = true;
            }
        }
        
        // Crea la griglia per la parola
        function createWordGrid() {
            wordGrid.innerHTML = '';
            for (let i = 0; i < currentWord.length; i++) {
                const letterBox = document.createElement('div');
                letterBox.className = 'letter-box';
                letterBox.id = `letter-${i}`;
                wordGrid.appendChild(letterBox);
            }
        }
        
        // Inizia a rivelare le lettere
        function startRevealingLetters() {
            const positions = Array.from({length: currentWord.length}, (_, i) => i);
            shuffleArray(positions);
            
            letterInterval = setInterval(() => {
                if (currentLetterIndex >= currentWord.length) {
                    return;
                }
                
                const pos = positions[currentLetterIndex];
                revealLetter(pos);
                currentLetterIndex++;
            }, 1500);
        }
        
        // Rivela una lettera
        function revealLetter(position) {
            const letterBox = document.getElementById(`letter-${position}`);
            letterBox.textContent = currentWord[position];
            letterBox.classList.add('revealed');
            letterBox.classList.add('pulse');
            revealedLetters.push(currentWord[position]);
            
            setTimeout(() => {
                letterBox.classList.remove('pulse');
            }, 500);
        }
        
        // Gestisce la pressione del buzzer
        function handleBuzzer() {
            if (!gameStarted) return;
            
            clearInterval(letterInterval);
            
            answeringPlayer = currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent;
            answeringPlayerElement.textContent = `üé§ Risponde: ${answeringPlayer}`;
            
            const teamName = currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent;
            
            message.textContent = `üéØ ${teamName}, qual √® la parola?`;
            buzzer.disabled = true;
            answerControls.classList.remove('hidden');
        }
        
        // Gestisce una risposta corretta
        function handleCorrectAnswer() {
            message.textContent = `‚úÖ Esatto! La parola √® "${currentWord}". +10 punti per la ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            revealAllLetters();
            updateScore(currentTeam, 10);
            nextBtn.disabled = false;
            answerControls.classList.add('hidden');
            
            currentTeam = currentTeam === 'A' ? 'B' : 'A';
            updateActiveTeam();
            message.textContent += ` üîÑ Adesso tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
        }
        
        // Gestisce una risposta errata
        function handleWrongAnswer() {
            currentTeam = currentTeam === 'A' ? 'B' : 'A';
            updateActiveTeam();
            
            message.textContent = `‚ùå Risposta errata! Adesso tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            answerControls.classList.add('hidden');
            startRevealingLetters();
            buzzer.disabled = false;
        }
        
        // Rivela tutte le lettere
        function revealAllLetters() {
            for (let i = 0; i < currentWord.length; i++) {
                const letterBox = document.getElementById(`letter-${i}`);
                if (!letterBox.textContent) {
                    letterBox.textContent = currentWord[i];
                    letterBox.classList.add('revealed');
                }
            }
        }
        
        // Passa alla parola successiva
        function nextWord() {
            currentRound++;
            if (currentRound > totalRounds) {
                completeGame();
                return;
            }
            
            roundInfoElement.textContent = `üìù Parola: ${currentRound}/${totalRounds}`;
            resetGame();
            startBtn.disabled = false;
            updateActiveTeam();
            message.textContent = `üîÑ Prossima parola! Inizia la ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
        }
        
        // Completa il gioco Caccia alla Parola
        function completeGame() {
            message.textContent = 'üéâ Hai completato tutte le parole!';
            startBtn.disabled = true;
            buzzer.disabled = true;
            nextBtn.disabled = true;
            gameCompleted.classList.remove('hidden');
            
            // Ferma la musica
            skipMusic();
        }
        
        // Aggiorna il punteggio
        function updateScore(team, points) {
            if (team === 'A') {
                scoreA += points;
                scoreAElement.textContent = scoreA;
                secondScoreA.textContent = scoreA;
                thirdScoreA.textContent = scoreA;
                fourthScoreA.textContent = scoreA;
                
                // Aggiungi animazione
                scoreAElement.classList.add('score-pop');
                setTimeout(() => {
                    scoreAElement.classList.remove('score-pop');
                }, 500);
            } else {
                scoreB += points;
                scoreBElement.textContent = scoreB;
                secondScoreB.textContent = scoreB;
                thirdScoreB.textContent = scoreB;
                fourthScoreB.textContent = scoreB;
                
                // Aggiungi animazione
                scoreBElement.classList.add('score-pop');
                setTimeout(() => {
                    scoreBElement.classList.remove('score-pop');
                }, 500);
            }
        }
        
        // Funzione per mescolare un array (algoritmo Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // Inizia il gioco principale dopo il setup
        function startMainGame() {
            displayTeamA.textContent = teamANameInput.value;
            displayTeamB.textContent = teamBNameInput.value;
            
            secondDisplayTeamA.textContent = teamANameInput.value;
            secondDisplayTeamB.textContent = teamBNameInput.value;
            
            thirdDisplayTeamA.textContent = teamANameInput.value;
            thirdDisplayTeamB.textContent = teamBNameInput.value;
            
            fourthDisplayTeamA.textContent = teamANameInput.value;
            fourthDisplayTeamB.textContent = teamBNameInput.value;
            
            setupScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            initGame();
        }
        
        // Passa al secondo gioco
        function startSecondGame() {
            gameScreen.classList.add('hidden');
            secondGameScreen.classList.remove('hidden');
            
            initSecondGame();
        }
        
        // RIPRODUCI LA MUSICA SOLO QUI, quando inizia effettivamente il primo gioco E SOLO UNA VOLTA
        function playIntroMusic() {
            // Assicurati che la musica sia ferma prima di iniziare
            skipMusic();
            
            introMusic.volume = 0.5;
            
            // Mostra il timer
            musicTimer.classList.remove('hidden');
            let timeLeft = 20;
            musicTimeLeftElement.textContent = timeLeft;
            
            // Aggiorna il timer ogni secondo
            musicTimerInterval = setInterval(() => {
                timeLeft--;
                musicTimeLeftElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(musicTimerInterval);
                    musicTimer.classList.add('hidden');
                }
            }, 1000);
            
            // Tentativo di riproduzione con gestione errori
            const playPromise = introMusic.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    // Musica riprodotta con successo
                }).catch(error => {
                    console.log("Errore nella riproduzione:", error);
                    skipMusic();
                });
            }
            
            musicTimeout = setTimeout(() => {
                skipMusic();
            }, 20000);
        }
        
        // Salta la musica
        function skipMusic() {
            introMusic.pause();
            introMusic.currentTime = 0;
            clearTimeout(musicTimeout);
            clearInterval(musicTimerInterval);
            musicTimer.classList.add('hidden');
        }
        
        // Inizializzazione del secondo gioco
        function initSecondGame() {
            resetSecondGame();
            updateSecondScores();
            secondRoundInfo.textContent = `üìã Quartina: ${secondCurrentRound}/${secondTotalRounds}`;
            secondMessage.textContent = "üéØ Premi 'INIZIA QUARTINA' per iniziare il gioco!";
            quartinaPoints = 20;
            updateQuartinaPointsDisplay();
            
            secondStartBtn.disabled = false;
            secondNextBtn.disabled = true;
            secondNextQuartinaBtn.disabled = true;
            secondPlayerBuzzers.classList.add('hidden');
            secondAnswerControls.classList.add('hidden');
        }
        
        // Reset del secondo gioco
        function resetSecondGame() {
            secondGameStarted = false;
            currentQuartinaStep = 0;
            resetQuartinaDisplay();
            secondAnswerControls.classList.add('hidden');
            correctAnswerDisplay.classList.add('hidden');
            secondNextQuartinaBtn.disabled = true;
            secondPlayerBuzzers.classList.add('hidden');
            secondBuzzerA.disabled = false;
            secondBuzzerB.disabled = false;
        }
        
        // Reset della visualizzazione della quartina
        function resetQuartinaDisplay() {
            quandoLine.classList.remove('revealed');
            doveLine.classList.remove('revealed');
            comeLine.classList.remove('revealed');
            percheLine.classList.remove('revealed');
            
            quandoText.textContent = "‚è∞ (Quando)";
            doveText.textContent = "üìç (Dove)";
            comeText.textContent = "üé≠ (Come)";
            percheText.textContent = "‚ùì (Perch√©)";
        }
        
        // Aggiorna display punti quartina
        function updateQuartinaPointsDisplay() {
            pointsValueElement.textContent = quartinaPoints;
        }
        
        // Avvia il secondo gioco
        function startSecondGameRound() {
            if (secondGameStarted) return;
            
            secondGameStarted = true;
            currentQuartinaStep = 0;
            secondStartBtn.disabled = true;
            secondNextBtn.disabled = false;
            secondNextQuartinaBtn.disabled = true;
            
            revealQuartinaStep();
            secondMessage.textContent = `üîç Indovina a cosa si riferisce la quartina! Tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            quartinaPoints = 40;
            updateQuartinaPointsDisplay();
            
            // Mostra i buzzer delle squadre
            secondPlayerBuzzers.classList.remove('hidden');
        }
        
        // Rivela il passo successivo della quartina
        function revealNextQuartinaStep() {
            if (currentQuartinaStep >= 3) return;
            
            currentQuartinaStep++;
            revealQuartinaStep();
            
            if (currentQuartinaStep === 1) {
                quartinaPoints = 30;
            } else if (currentQuartinaStep === 2) {
                quartinaPoints = 20;
            } else if (currentQuartinaStep === 3) {
                quartinaPoints = 10;
                secondNextBtn.disabled = true;
                secondNextQuartinaBtn.disabled = false;
                secondMessage.textContent = "‚è∞ Quartina completata! Nessuno ha indovinato.";
                showCorrectAnswer();
            }
            updateQuartinaPointsDisplay();
        }
        
        // Rivela il passo corrente della quartina
        function revealQuartinaStep() {
            const currentQuartina = quartineList[secondCurrentRound - 1];
            
            if (currentQuartinaStep >= 0) {
                quandoLine.classList.add('revealed');
                quandoText.textContent = currentQuartina.quando;
            }
            
            if (currentQuartinaStep >= 1) {
                doveLine.classList.add('revealed');
                doveText.textContent = currentQuartina.dove;
            }
            
            if (currentQuartinaStep >= 2) {
                comeLine.classList.add('revealed');
                comeText.textContent = currentQuartina.come;
            }
            
            if (currentQuartinaStep >= 3) {
                percheLine.classList.add('revealed');
                percheText.textContent = currentQuartina.perche;
            }
        }
        
        // Mostra la risposta corretta
        function showCorrectAnswer() {
            const currentQuartina = quartineList[secondCurrentRound - 1];
            correctAnswerText.textContent = currentQuartina.risposta;
            correctAnswerDisplay.classList.remove('hidden');
        }
        
        // Gestisce il buzzer della squadra A nel secondo gioco
        function handleSecondBuzzerA() {
            handleSecondBuzzer('A');
        }
        
        // Gestisce il buzzer della squadra B nel secondo gioco
        function handleSecondBuzzerB() {
            handleSecondBuzzer('B');
        }
        
        // Gestisce il buzzer nel secondo gioco
        function handleSecondBuzzer(team) {
            currentAnsweringTeam = team;
            currentAnsweringPlayer = team === 'A' ? displayTeamA.textContent : displayTeamB.textContent;
            
            secondAnsweringPlayer.textContent = `üé§ Risponde: ${currentAnsweringPlayer}`;
            secondMessage.textContent = `üéØ ${currentAnsweringPlayer}, qual √® la risposta?`;
            
            secondBuzzerA.disabled = true;
            secondBuzzerB.disabled = true;
            secondAnswerControls.classList.remove('hidden');
        }
        
        // Gestisce una risposta corretta nel secondo gioco
        function handleSecondCorrectAnswer() {
            const currentQuartina = quartineList[secondCurrentRound - 1];
            
            secondMessage.textContent = `‚úÖ Esatto! La risposta √® "${currentQuartina.risposta}". +${quartinaPoints} punti per la ${currentAnsweringTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            updateScore(currentAnsweringTeam, quartinaPoints);
            
            revealAllQuartinaSteps();
            secondNextQuartinaBtn.disabled = false;
            secondAnswerControls.classList.add('hidden');
            correctAnswerDisplay.classList.add('hidden');
            secondPlayerBuzzers.classList.add('hidden');
        }
        
        // Gestisce una risposta errata nel secondo gioco
        function handleSecondWrongAnswer() {
            secondMessage.textContent = "‚ùå Risposta errata! La quartina continua...";
            secondAnswerControls.classList.add('hidden');
            secondBuzzerA.disabled = false;
            secondBuzzerB.disabled = false;
        }
        
        // Rivela tutti i passi della quartina
        function revealAllQuartinaSteps() {
            currentQuartinaStep = 3;
            revealQuartinaStep();
        }
        
        // Passa alla quartina successiva
        function nextQuartina() {
            secondCurrentRound++;
            if (secondCurrentRound > secondTotalRounds) {
                completeSecondGame();
                return;
            }
            
            secondRoundInfo.textContent = `üìã Quartina: ${secondCurrentRound}/${secondTotalRounds}`;
            resetSecondGame();
            secondStartBtn.disabled = false;
            secondMessage.textContent = `üîÑ Prossima quartina! Premi "INIZIA QUARTINA" per iniziare.`;
        }
        
        // Completa il secondo gioco
        function completeSecondGame() {
            secondMessage.textContent = 'üéâ Hai completato tutte le quartine!';
            secondStartBtn.disabled = true;
            secondNextBtn.disabled = true;
            secondNextQuartinaBtn.disabled = true;
            secondGameCompleted.classList.remove('hidden');
        }
        
        // Passa al terzo gioco
        function startThirdGame() {
            secondGameScreen.classList.add('hidden');
            thirdGameScreen.classList.remove('hidden');
            
            initThirdGame();
        }
        
        // Inizializzazione del terzo gioco
        function initThirdGame() {
            resetThirdGame();
            updateThirdScores();
            thirdRoundInfo.textContent = `üîó Catena: ${thirdCurrentRound}/${thirdTotalRounds}`;
            thirdMessage.textContent = `üéØ Scegli da che direzione iniziare la catena!`;
            
            createChainDisplay();
            
            thirdStartBtn.disabled = false;
            thirdBuzzer.disabled = true;
            thirdNextBtn.disabled = true;
            directionOptions.classList.add('hidden');
            zipContainer.classList.add('hidden');
        }
        
        // Reset del terzo gioco
        function resetThirdGame() {
            thirdGameStarted = false;
            currentChainDirection = '';
            currentChainPosition = 0;
            currentHiddenWordIndex = 0;
            zipGameActive = false;
            revealedLettersPerWord = [];
            currentRevealedLetters = [];
            
            chainDirection.classList.remove('hidden');
            zipContainer.classList.add('hidden');
            thirdAnswerControls.classList.add('hidden');
            zipAnswerControls.classList.add('hidden');
            zipCorrectAnswer.classList.add('hidden');
            directionOptions.classList.add('hidden');
        }
        
        // Crea la visualizzazione della catena
        function createChainDisplay() {
            chainContainer.innerHTML = '';
            const currentChain = chainList[thirdCurrentRound - 1];
            
            // Inizializza l'array per tenere traccia delle lettere rivelate
            revealedLettersPerWord = [];
            for (let i = 0; i < currentChain.words.length; i++) {
                revealedLettersPerWord[i] = [];
            }
            
            for (let i = 0; i < currentChain.words.length; i++) {
                const chainWord = document.createElement('div');
                chainWord.className = 'chain-word';
                
                if (i === 0 || i === currentChain.words.length - 1) {
                    // Prima e ultima parola sono sempre visibili
                    chainWord.textContent = currentChain.words[i];
                    chainWord.classList.add('revealed');
                } else {
                    // Parole nascoste - mostra prima e ultima lettera
                    const word = currentChain.words[i];
                    let displayText = word.charAt(0) + '_'.repeat(word.length - 2) + word.charAt(word.length - 1);
                    chainWord.textContent = displayText;
                    chainWord.classList.add('hidden-word');
                    chainWord.id = `chain-word-${i}`;
                    
                    // Salva le lettere iniziali rivelate
                    revealedLettersPerWord[i].push(0); // Prima lettera
                    revealedLettersPerWord[i].push(word.length - 1); // Ultima lettera
                }
                
                chainContainer.appendChild(chainWord);
            }
        }
        
        // Gestisce la scelta della direzione
        function handleDirectionChoice(direction) {
            currentChainDirection = direction;
            
            // Evidenzia il pulsante selezionato
            if (direction === 'top') {
                topDirectionBtn.classList.add('active');
                bottomDirectionBtn.classList.remove('active');
            } else {
                bottomDirectionBtn.classList.add('active');
                topDirectionBtn.classList.remove('active');
            }
            
            thirdMessage.textContent = `üéØ Hai scelto di iniziare ${direction === 'top' ? "dall'alto" : "dal basso"}! Premi "INIZIA CATENA" per cominciare.`;
            thirdStartBtn.disabled = false;
        }
        
        // Avvia il terzo gioco
        function startThirdGameRound() {
            if (thirdGameStarted) return;
            
            thirdGameStarted = true;
            chainDirection.classList.add('hidden');
            thirdStartBtn.disabled = true;
            thirdBuzzer.disabled = false;
            thirdNextBtn.disabled = true;
            
            // Determina la posizione iniziale in base alla direzione scelta
            if (currentChainDirection === 'top') {
                currentChainPosition = 0;
                currentHiddenWordIndex = 1;
            } else {
                currentChainPosition = chainList[thirdCurrentRound - 1].words.length - 1;
                currentHiddenWordIndex = chainList[thirdCurrentRound - 1].words.length - 2;
            }
            
            highlightCurrentWord();
            thirdMessage.textContent = `üîç Indovina la parola nascosta! Tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
        }
        
        // Evidenzia la parola corrente
        function highlightCurrentWord() {
            // Rimuovi evidenziazione da tutte le parole
            const allWords = document.querySelectorAll('.chain-word');
            allWords.forEach(word => {
                word.classList.remove('glow');
            });
            
            // Evidenzia la parola corrente
            if (currentChainDirection === 'top') {
                if (currentHiddenWordIndex < chainList[thirdCurrentRound - 1].words.length - 1) {
                    const wordElement = document.getElementById(`chain-word-${currentHiddenWordIndex}`);
                    if (wordElement) wordElement.classList.add('glow');
                }
            } else {
                if (currentHiddenWordIndex > 0) {
                    const wordElement = document.getElementById(`chain-word-${currentHiddenWordIndex}`);
                    if (wordElement) wordElement.classList.add('glow');
                }
            }
        }
        
        // Gestisce il buzzer nel terzo gioco
        function handleThirdBuzzer() {
            if (!thirdGameStarted) return;
            
            thirdAnsweringPlayer.textContent = `üé§ Risponde: ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            thirdMessage.textContent = `üéØ ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}, qual √® la parola nascosta?`;
            thirdBuzzer.disabled = true;
            thirdAnswerControls.classList.remove('hidden');
        }
        
        // Verifica se tutte le parole sono state rivelate
        function checkAllWordsRevealed() {
            const currentChain = chainList[thirdCurrentRound - 1];
            for (let i = 1; i < currentChain.words.length - 1; i++) {
                const wordElement = document.getElementById(`chain-word-${i}`);
                if (wordElement && wordElement.classList.contains('hidden-word')) {
                    return false; // Trovata una parola ancora nascosta
                }
            }
            return true; // Tutte le parole sono rivelate
        }
        
        // Completa una catena
        function completeChain() {
            thirdMessage.textContent = `üéâ Catena completata! +25 punti bonus per la ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            updateScore(currentTeam, 25);
            
            thirdBuzzer.disabled = true;
            thirdAnswerControls.classList.add('hidden');
            directionOptions.classList.add('hidden');
            
            // Controlla se entrambe le catena sono state completate
            const allWordsRevealed = checkAllWordsRevealed();
            
            if (allWordsRevealed) {
                if (thirdCurrentRound >= thirdTotalRounds) {
                    // Attiva il gioco della ZIP solo per la seconda catena
                    const currentChain = chainList[thirdCurrentRound - 1];
                    if (currentChain.zip) {
                        setTimeout(() => {
                            startZipGame();
                        }, 2000);
                    } else {
                        thirdNextBtn.disabled = false;
                        thirdMessage.textContent += ` Premi "PROSSIMA CATENA" per continuare.`;
                    }
                } else {
                    // Abilita il pulsante per passare alla prossima catena
                    thirdNextBtn.disabled = false;
                    thirdMessage.textContent += ` Premi "PROSSIMA CATENA" per continuare.`;
                }
            }
        }
        
        // Gestisce una risposta corretta nel terzo gioco
        function handleThirdCorrectAnswer() {
            const currentChain = chainList[thirdCurrentRound - 1];
            const correctWord = currentChain.words[currentHiddenWordIndex];
            
            // Rivela completamente la parola
            const wordElement = document.getElementById(`chain-word-${currentHiddenWordIndex}`);
            wordElement.textContent = correctWord;
            wordElement.classList.remove('hidden-word');
            wordElement.classList.add('revealed');
            wordElement.classList.remove('glow');
            
            thirdMessage.textContent = `‚úÖ Esatto! La parola √® "${correctWord}". +15 punti per la ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            updateScore(currentTeam, 15);
            
            // La squadra mantiene il turno
            thirdAnswerControls.classList.add('hidden');
            
            // Verifica se la catena √® completata
            const allWordsRevealed = checkAllWordsRevealed();
            
            if (allWordsRevealed) {
                completeChain();
                return;
            }
            
            thirdBuzzer.disabled = false;
            
            // Aggiorna la posizione
            if (currentChainDirection === 'top') {
                currentHiddenWordIndex++;
                if (currentHiddenWordIndex >= currentChain.words.length - 1) {
                    // Catena completata dall'alto
                    completeChain();
                    return;
                }
            } else {
                currentHiddenWordIndex--;
                if (currentHiddenWordIndex <= 0) {
                    // Catena completata dal basso
                    completeChain();
                    return;
                }
            }
            
            // Mostra opzioni per cambiare direzione
            showDirectionOptions();
        }
        
        // Mostra le opzioni per cambiare direzione
        function showDirectionOptions() {
            thirdMessage.textContent = `üéØ ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}, vuoi continuare nella stessa direzione o cambiare?`;
            directionOptions.classList.remove('hidden');
        }
        
        // Continua nella stessa direzione
        function continueDirection() {
            directionOptions.classList.add('hidden');
            highlightCurrentWord();
            thirdMessage.textContent = `üîç Indovina la prossima parola nascosta! Tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
        }
        
        // Cambia direzione
        function changeDirection() {
            currentChainDirection = currentChainDirection === 'top' ? 'bottom' : 'top';
            directionOptions.classList.add('hidden');
            
            // CORREZIONE: Trova la prima parola nascosta disponibile nella nuova direzione
            const currentChain = chainList[thirdCurrentRound - 1];
            
            if (currentChainDirection === 'top') {
                // Dall'alto: cerca la prima parola nascosta dall'inizio
                for (let i = 1; i < currentChain.words.length - 1; i++) {
                    const wordElement = document.getElementById(`chain-word-${i}`);
                    if (wordElement && wordElement.classList.contains('hidden-word')) {
                        currentHiddenWordIndex = i;
                        break;
                    }
                }
            } else {
                // Dal basso: cerca la prima parola nascosta dalla fine
                for (let i = currentChain.words.length - 2; i > 0; i--) {
                    const wordElement = document.getElementById(`chain-word-${i}`);
                    if (wordElement && wordElement.classList.contains('hidden-word')) {
                        currentHiddenWordIndex = i;
                        break;
                    }
                }
            }
            
            highlightCurrentWord();
            thirdMessage.textContent = `üîÑ Hai cambiato direzione! Indovina la parola nascosta! Tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
        }
        
        // Gestisce una risposta errata nel terzo gioco
        function handleThirdWrongAnswer() {
            // Aggiungi una lettera alla parola
            revealAdditionalLetter();
            
            // Cambia squadra
            currentTeam = currentTeam === 'A' ? 'B' : 'A';
            
            // Verifica se la parola √® stata completamente rivelata
            const wordElement = document.getElementById(`chain-word-${currentHiddenWordIndex}`);
            if (wordElement && !wordElement.classList.contains('hidden-word')) {
                // Se la parola √® stata completamente rivelata, passa alla prossima
                if (currentChainDirection === 'top') {
                    currentHiddenWordIndex++;
                } else {
                    currentHiddenWordIndex--;
                }
                
                // Verifica se la catena √® completata
                const allWordsRevealed = checkAllWordsRevealed();
                if (allWordsRevealed) {
                    completeChain();
                    return;
                }
            }
            
            thirdMessage.textContent = `‚ùå Risposta errata! Una lettera √® stata rivelata. Adesso tocca alla ${currentTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            thirdAnswerControls.classList.add('hidden');
            thirdBuzzer.disabled = false;
            
            // Evidenzia la parola corrente
            highlightCurrentWord();
        }
        
        // Rivela una lettera aggiuntiva quando si sbaglia
        function revealAdditionalLetter() {
            const currentChain = chainList[thirdCurrentRound - 1];
            const word = currentChain.words[currentHiddenWordIndex];
            const wordElement = document.getElementById(`chain-word-${currentHiddenWordIndex}`);
            
            // Trova una lettera non ancora rivelata
            const unrevealedPositions = [];
            for (let i = 0; i < word.length; i++) {
                if (!revealedLettersPerWord[currentHiddenWordIndex].includes(i)) {
                    unrevealedPositions.push(i);
                }
            }
            
            if (unrevealedPositions.length > 0) {
                // Scegli una posizione casuale
                const randomIndex = Math.floor(Math.random() * unrevealedPositions.length);
                const position = unrevealedPositions[randomIndex];
                
                // Aggiungi alla lista delle lettere rivelate
                revealedLettersPerWord[currentHiddenWordIndex].push(position);
                
                // Aggiorna la visualizzazione
                updateWordDisplay(currentHiddenWordIndex);
            }
        }
        
        // Aggiorna la visualizzazione di una parola
        function updateWordDisplay(wordIndex) {
            const currentChain = chainList[thirdCurrentRound - 1];
            const word = currentChain.words[wordIndex];
            const wordElement = document.getElementById(`chain-word-${wordIndex}`);
            
            let displayText = '';
            for (let i = 0; i < word.length; i++) {
                if (revealedLettersPerWord[wordIndex].includes(i)) {
                    displayText += word.charAt(i);
                } else {
                    displayText += '_';
                }
            }
            
            wordElement.textContent = displayText;
            
            // Se tutte le lettere sono rivelate, rimuovi la classe hidden-word
            if (displayText.indexOf('_') === -1) {
                wordElement.classList.remove('hidden-word');
                wordElement.classList.add('revealed');
            }
        }
        
        // Avvia il gioco della ZIP
        function startZipGame() {
            zipGameActive = true;
            chainContainer.classList.add('hidden'); // Nasconde la catena
            zipContainer.classList.remove('hidden'); // Mostra la ZIP
            
            const currentChain = chainList[thirdCurrentRound - 1];
            const zipData = currentChain.zip;
            
            // Imposta le parole della ZIP con lettere nascoste
            zipFirstWord.textContent = zipData.first;
            zipSecondWord.textContent = "D__I"; // DATI con lettere nascoste
            zipThirdWord.textContent = "C___O"; // CAMPO con lettere nascoste
            zipFourthWord.textContent = zipData.fourth;
            
            zipMessage.textContent = `üéØ Hai completato la catena! La ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent} ha 5 secondi extra per la ZIP!`;
            zipOptions.classList.remove('hidden');
            zipAnswerControls.classList.add('hidden');
            zipCorrectAnswer.classList.add('hidden');
            zipTimer.classList.add('hidden');
            
            // Determina quale squadra pu√≤ giocare la ZIP
            zipPlayingTeam = currentTeam;
            
            // Aggiungi 5 secondi extra per la squadra che ha completato l'ultima catena
            prizeValueElement.textContent = "50 (5 secondi extra)";
        }
        
        // Gestisce la scelta di giocare la ZIP
        function handlePlayZip() {
            zipOptions.classList.add('hidden');
            zipMessage.textContent = `üéØ ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}, indovina le due parole mancanti! Hai 10 secondi!`;
            
            zipAnsweringPlayer.textContent = `üé§ Risponde: ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            zipAnswerControls.classList.remove('hidden');
            
            // Avvia il timer di 10 secondi
            startZipTimer();
        }
        
        // Avvia il timer per la ZIP
        function startZipTimer() {
            zipTimer.classList.remove('hidden');
            zipTimeLeft = 10;
            zipTimeLeftElement.textContent = zipTimeLeft;
            
            zipTimerInterval = setInterval(() => {
                zipTimeLeft--;
                zipTimeLeftElement.textContent = zipTimeLeft;
                
                if (zipTimeLeft <= 0) {
                    clearInterval(zipTimerInterval);
                    // Tempo scaduto - passa alla squadra avversaria
                    handleZipTimeExpired();
                }
            }, 1000);
        }
        
        // Gestisce il tempo scaduto per la ZIP
        function handleZipTimeExpired() {
            zipTimer.classList.add('hidden');
            zipMessage.textContent = `‚è∞ Tempo scaduto! Adesso tocca a ${zipPlayingTeam === 'A' ? displayTeamB.textContent : displayTeamA.textContent} rispondere immediatamente!`;
            zipAnswerControls.classList.add('hidden');
            
            // Cambia squadra
            zipPlayingTeam = zipPlayingTeam === 'A' ? 'B' : 'A';
            zipAnsweringPlayer.textContent = `üé§ Risponde: ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
            
            setTimeout(() => {
                zipMessage.textContent = `üéØ ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}, rispondi subito!`;
                zipAnswerControls.classList.remove('hidden');
            }, 2000);
        }
        
        // Gestisce la scelta di passare la ZIP
        function handlePassZip() {
            zipPlayingTeam = zipPlayingTeam === 'A' ? 'B' : 'A';
            zipOptions.classList.add('hidden');
            zipMessage.textContent = `üîÑ Hai passato la mano! Adesso tocca a ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent} giocare la ZIP.`;
            
            setTimeout(() => {
                zipMessage.textContent = `üéØ ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}, indovina le due parole mancanti! Hai 10 secondi!`;
                zipAnsweringPlayer.textContent = `üé§ Risponde: ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}`;
                zipAnswerControls.classList.remove('hidden');
                
                // Avvia il timer di 10 secondi
                startZipTimer();
            }, 2000);
        }
        
        // Gestisce una risposta corretta alla ZIP
        function handleZipCorrect() {
            clearInterval(zipTimerInterval);
            zipTimer.classList.add('hidden');
            
            const currentChain = chainList[thirdCurrentRound - 1];
            const zipData = currentChain.zip;
            
            zipMessage.textContent = `‚úÖ Esatto! La risposta √® "${zipData.answer}". +50 punti per la ${zipPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            updateScore(zipPlayingTeam, 50);
            
            // Rivela le parole nascoste
            zipSecondWord.textContent = zipData.second;
            zipThirdWord.textContent = zipData.third;
            zipSecondWord.classList.remove('hidden-word');
            zipThirdWord.classList.remove('hidden-word');
            zipSecondWord.classList.add('revealed');
            zipThirdWord.classList.add('revealed');
            
            zipAnswerControls.classList.add('hidden');
            thirdNextBtn.disabled = false;
        }
        
        // Gestisce una risposta errata alla ZIP
        function handleZipWrong() {
            clearInterval(zipTimerInterval);
            zipTimer.classList.add('hidden');
            
            // L'altra squadra vince i punti
            const winningTeam = zipPlayingTeam === 'A' ? 'B' : 'A';
            zipMessage.textContent = `‚ùå Risposta errata! +50 punti per la ${winningTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            updateScore(winningTeam, 50);
            
            // Mostra la risposta corretta
            const currentChain = chainList[thirdCurrentRound - 1];
            const zipData = currentChain.zip;
            zipAnswerText.textContent = zipData.answer;
            zipCorrectAnswer.classList.remove('hidden');
            
            // Rivela le parole nascoste
            zipSecondWord.textContent = zipData.second;
            zipThirdWord.textContent = zipData.third;
            zipSecondWord.classList.remove('hidden-word');
            zipThirdWord.classList.remove('hidden-word');
            zipSecondWord.classList.add('revealed');
            zipThirdWord.classList.add('revealed');
            
            zipAnswerControls.classList.add('hidden');
            thirdNextBtn.disabled = false;
        }
        
        // Passa alla catena successiva
        function nextChain() {
            thirdCurrentRound++;
            if (thirdCurrentRound > thirdTotalRounds) {
                completeThirdGame();
                return;
            }
            
            // La squadra che ha indovinato l'ultimo collegamento mantiene il turno per la ZIP
            // (currentTeam rimane la stessa)
            
            thirdRoundInfo.textContent = `üîó Catena: ${thirdCurrentRound}/${thirdTotalRounds}`;
            resetThirdGame();
            initThirdGame();
        }
        
        // Completa il terzo gioco
        function completeThirdGame() {
            thirdMessage.textContent = 'üéâ Hai completato tutte le catene!';
            thirdStartBtn.disabled = true;
            thirdBuzzer.disabled = true;
            thirdNextBtn.disabled = true;
            thirdGameCompleted.classList.remove('hidden');
        }
        
        // Passa al quarto gioco (L'Intesa Vincente)
        function startFourthGame() {
            thirdGameScreen.classList.add('hidden');
            fourthGameScreen.classList.remove('hidden');
            
            initFourthGame();
        }
        
        // Inizializzazione del quarto gioco (L'Intesa Vincente)
        function initFourthGame() {
            resetFourthGame();
            updateFourthScores();
            
            // Determina quale squadra inizia (quella con il punteggio pi√π basso)
            currentPlayingTeam = scoreA <= scoreB ? 'A' : 'B';
            
            // Imposta i ruoli dei giocatori
            setPlayerRoles();
            
            // Imposta il bonus della ZIP
            zipBonusTimeElement.textContent = zipBonusTime;
            
            fourthMessage.textContent = `üéØ Inizia la ${currentPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}! Premi "INIZIA MANCHE" per cominciare.`;
            
            fourthStartBtn.disabled = false;
            fourthBuzzer.disabled = true;
            passBtn.disabled = true;
            doubleBtn.disabled = true;
            fourthAnswerControls.classList.add('hidden');
            fourthCorrectAnswer.classList.add('hidden');
            intesaFinal.classList.add('hidden');
        }
        
        // Reset del quarto gioco
        function resetFourthGame() {
            fourthGameStarted = false;
            currentWordIndex = 0;
            wordsGuessedA = 0;
            wordsGuessedB = 0;
            passesRemaining = 3;
            doublesRemaining = 2;
            clearInterval(intesaTimerInterval);
            intesaTimeLeft = 60;
            currentQuestion = '';
            currentHiddenWord = '';
            isDoubleRound = false;
            currentSuggeritoreIndex = 0;
            
            updateIntesaStats();
        }
        
        // Imposta i ruoli dei giocatori
        function setPlayerRoles() {
            // Assegna casualmente i ruoli per ogni squadra
            if (teamAPlayers.length >= 3) {
                const shuffledA = [...teamAPlayers].sort(() => Math.random() - 0.5);
                suggeritore1A.textContent = shuffledA[0];
                suggeritore2A.textContent = shuffledA[1];
                indovinoA.textContent = shuffledA[2];
            }
            
            if (teamBPlayers.length >= 3) {
                const shuffledB = [...teamBPlayers].sort(() => Math.random() - 0.5);
                suggeritore1B.textContent = shuffledB[0];
                suggeritore2B.textContent = shuffledB[1];
                indovinoB.textContent = shuffledB[2];
            }
        }
        
        // Aggiorna le statistiche dell'Intesa Vincente
        function updateIntesaStats() {
            wordsGuessedAElement.textContent = wordsGuessedA;
            wordsGuessedBElement.textContent = wordsGuessedB;
            passesRemainingElement.textContent = passesRemaining;
            doublesRemainingElement.textContent = doublesRemaining;
            passCount.textContent = passesRemaining;
            doubleCount.textContent = doublesRemaining;
        }
        
        // Avvia una manche dell'Intesa Vincente
        function startIntesaManche() {
            if (fourthGameStarted) return;
            
            fourthGameStarted = true;
            fourthStartBtn.disabled = true;
            fourthBuzzer.disabled = false;
            passBtn.disabled = false;
            doubleBtn.disabled = false;
            
            // Imposta il tempo in base al bonus ZIP
            intesaTimeLeft = 60 + (currentPlayingTeam === zipPlayingTeam ? zipBonusTime : 0);
            intesaTimeLeftElement.textContent = intesaTimeLeft;
            
            // Avvia il timer
            startIntesaTimer();
            
            // Mostra la prima parola
            showNextWord();
            
            fourthMessage.textContent = `üéØ ${currentPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}, i suggeritori iniziano a formulare la domanda!`;
        }
        
        // Avvia il timer dell'Intesa Vincente
        function startIntesaTimer() {
            intesaTimerInterval = setInterval(() => {
                intesaTimeLeft--;
                intesaTimeLeftElement.textContent = intesaTimeLeft;
                
                if (intesaTimeLeft <= 0) {
                    clearInterval(intesaTimerInterval);
                    endIntesaManche();
                }
            }, 1000);
        }
        
        // Mostra la prossima parola
        function showNextWord() {
            currentWordIndex++;
            currentWordNumber.textContent = currentWordIndex;
            
            // Scegli una parola casuale
            if (isDoubleRound && doublesRemaining > 0) {
                // Usa una locuzione per il raddoppio
                currentHiddenWord = doubleWords[Math.floor(Math.random() * doubleWords.length)];
            } else {
                // Usa una parola normale
                currentHiddenWord = intesaWords[Math.floor(Math.random() * intesaWords.length)];
            }
            
            hiddenWordText.textContent = currentHiddenWord;
            currentQuestion = '';
            questionText.textContent = "I suggeritori iniziano a formulare la domanda...";
            currentSuggeritoreIndex = 0;
            
            // Abilita il buzzer
            fourthBuzzer.disabled = false;
        }
        
        // Gestisce il buzzer nell'Intesa Vincente
        function handleFourthBuzzer() {
            if (!fourthGameStarted) return;
            
            // Ferma il timer temporaneamente
            clearInterval(intesaTimerInterval);
            
            const indovino = currentPlayingTeam === 'A' ? indovinoA.textContent : indovinoB.textContent;
            fourthAnsweringPlayer.textContent = `üé§ Risponde: ${indovino}`;
            fourthMessage.textContent = `üéØ ${indovino}, qual √® la risposta?`;
            
            fourthBuzzer.disabled = true;
            fourthAnswerControls.classList.remove('hidden');
        }
        
        // Gestisce una risposta corretta nell'Intesa Vincente
        function handleFourthCorrectAnswer() {
            if (currentPlayingTeam === 'A') {
                wordsGuessedA += isDoubleRound ? 2 : 1;
            } else {
                wordsGuessedB += isDoubleRound ? 2 : 1;
            }
            
            fourthMessage.textContent = `‚úÖ Esatto! La risposta √® "${currentHiddenWord}". +${isDoubleRound ? 2 : 1} punto/i per la ${currentPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}!`;
            
            // Se era un raddoppio, consumalo
            if (isDoubleRound) {
                doublesRemaining--;
                isDoubleRound = false;
            }
            
            updateIntesaStats();
            fourthAnswerControls.classList.add('hidden');
            
            // Riprendi il timer e mostra la prossima parola
            startIntesaTimer();
            showNextWord();
        }
        
        // Gestisce una risposta errata nell'Intesa Vincente
        function handleFourthWrongAnswer() {
            if (currentPlayingTeam === 'A' && wordsGuessedA > 0) {
                wordsGuessedA -= isDoubleRound ? 2 : 1;
                if (wordsGuessedA < 0) wordsGuessedA = 0;
            } else if (currentPlayingTeam === 'B' && wordsGuessedB > 0) {
                wordsGuessedB -= isDoubleRound ? 2 : 1;
                if (wordsGuessedB < 0) wordsGuessedB = 0;
            }
            
            fourthMessage.textContent = `‚ùå Risposta errata! -${isDoubleRound ? 2 : 1} punto/i per la ${currentPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent}.`;
            
            // Se era un raddoppio, consumalo
            if (isDoubleRound) {
                doublesRemaining--;
                isDoubleRound = false;
            }
            
            updateIntesaStats();
            fourthAnswerControls.classList.add('hidden');
            
            // Riprendi il timer e mostra la prossima parola
            startIntesaTimer();
            showNextWord();
        }
        
        // Gestisce il passaggio di una parola
        function handlePass() {
            if (passesRemaining <= 0) return;
            
            passesRemaining--;
            updateIntesaStats();
            
            fourthMessage.textContent = `üîÑ Parola passata! Passi rimanenti: ${passesRemaining}.`;
            
            // Mostra la prossima parola
            showNextWord();
        }
        
        // Gestisce il raddoppio
        function handleDouble() {
            if (doublesRemaining <= 0 || (currentPlayingTeam === 'A' && wordsGuessedA < 2) || (currentPlayingTeam === 'B' && wordsGuessedB < 2)) {
                fourthMessage.textContent = "‚ùå Non puoi usare il raddoppio ora! Devi avere almeno 2 punti.";
                return;
            }
            
            isDoubleRound = true;
            doublesRemaining--;
            updateIntesaStats();
            
            fourthMessage.textContent = `üîÑ RADDOPPIO ATTIVATO! La prossima parola varr√† 2 punti.`;
            
            // Mostra la prossima parola (che sar√† una locuzione)
            showNextWord();
        }
        
        // Termina una manche dell'Intesa Vincente
        function endIntesaManche() {
            fourthGameStarted = false;
            fourthBuzzer.disabled = true;
            passBtn.disabled = true;
            doubleBtn.disabled = true;
            
            fourthMessage.textContent = `‚è∞ Tempo scaduto! La ${currentPlayingTeam === 'A' ? displayTeamA.textContent : displayTeamB.textContent} ha indovinato ${currentPlayingTeam === 'A' ? wordsGuessedA : wordsGuessedB} parole.`;
            
            // Se √® la prima squadra, passa alla seconda
            if (currentPlayingTeam === 'A') {
                currentPlayingTeam = 'B';
                setTimeout(() => {
                    resetFourthGame();
                    fourthMessage.textContent = `üéØ Adesso tocca alla ${displayTeamB.textContent}! Premi "INIZIA MANCHE" per cominciare.`;
                    fourthStartBtn.disabled = false;
                }, 3000);
            } else {
                // Se entrambe le squadre hanno giocato, determina il vincitore
                setTimeout(() => {
                    determineIntesaWinner();
                }, 3000);
            }
        }
        
        // Determina il vincitore dell'Intesa Vincente
        function determineIntesaWinner() {
            let winner = '';
            let winnerPoints = 0;
            
            if (wordsGuessedA > wordsGuessedB) {
                winner = 'A';
                winnerPoints = wordsGuessedA;
            } else if (wordsGuessedB > wordsGuessedA) {
                winner = 'B';
                winnerPoints = wordsGuessedB;
            } else {
                // Pareggio - spareggio
                fourthMessage.textContent = "‚ö° PAREGGIO! Spareggio in corso...";
                setTimeout(() => {
                    handleIntesaTiebreaker();
                }, 2000);
                return;
            }
            
            // Mostra il vincitore
            championTeam.textContent = winner === 'A' ? displayTeamA.textContent : displayTeamB.textContent;
            finalBonus.textContent = "1000";
            wordBonus.textContent = winnerPoints * 1000;
            
            // Aggiorna il punteggio
            updateScore(winner, 1000 + (winnerPoints * 1000));
            
            intesaFinal.classList.remove('hidden');
            fourthMessage.textContent = `üéâ La ${winner === 'A' ? displayTeamA.textContent : displayTeamB.textContent} vince l'Intesa Vincente!`;
        }
        
        // Gestisce lo spareggio in caso di pareggio
        function handleIntesaTiebreaker() {
            // Implementazione semplificata dello spareggio
            fourthMessage.textContent = "‚ö° SPAREGGIO! Ogni squadra ha 15 secondi per indovinare una parola.";
            
            // Simula lo spareggio
            setTimeout(() => {
                // Assegna casualmente la vittoria per semplicit√†
                const randomWinner = Math.random() > 0.5 ? 'A' : 'B';
                championTeam.textContent = randomWinner === 'A' ? displayTeamA.textContent : displayTeamB.textContent;
                finalBonus.textContent = "1000";
                wordBonus.textContent = (randomWinner === 'A' ? wordsGuessedA : wordsGuessedB) * 1000;
                
                // Aggiorna il punteggio
                updateScore(randomWinner, 1000 + ((randomWinner === 'A' ? wordsGuessedA : wordsGuessedB) * 1000));
                
                intesaFinal.classList.remove('hidden');
                fourthMessage.textContent = `üéâ La ${randomWinner === 'A' ? displayTeamA.textContent : displayTeamB.textContent} vince l'Intesa Vincente dopo lo spareggio!`;
            }, 2000);
        }
        
        // Torna al menu principale
        function backToMainMenu() {
            fourthGameScreen.classList.add('hidden');
            setupScreen.classList.remove('hidden');
            
            currentRound = 1;
            secondCurrentRound = 1;
            thirdCurrentRound = 1;
            scoreA = 0;
            scoreB = 0;
            updateScores();
            initGame();
        }
        
        // Aggiorna i punteggi per tutti i giochi
        function updateScores() {
            scoreAElement.textContent = scoreA;
            scoreBElement.textContent = scoreB;
            secondScoreA.textContent = scoreA;
            secondScoreB.textContent = scoreB;
            thirdScoreA.textContent = scoreA;
            thirdScoreB.textContent = scoreB;
            fourthScoreA.textContent = scoreA;
            fourthScoreB.textContent = scoreB;
        }
        
        // Aggiorna i punteggi per il secondo gioco
        function updateSecondScores() {
            secondScoreA.textContent = scoreA;
            secondScoreB.textContent = scoreB;
        }
        
        // Aggiorna i punteggi per il terzo gioco
        function updateThirdScores() {
            thirdScoreA.textContent = scoreA;
            thirdScoreB.textContent = scoreB;
        }
        
        // Aggiorna i punteggi per il quarto gioco
        function updateFourthScores() {
            fourthScoreA.textContent = scoreA;
            fourthScoreB.textContent = scoreB;
        }
        
        // Aggiungi event listeners
        startBtn.addEventListener('click', startGame);
        buzzer.addEventListener('click', handleBuzzer);
        nextBtn.addEventListener('click', nextWord);
        startGameBtn.addEventListener('click', startMainGame);
        correctBtn.addEventListener('click', handleCorrectAnswer);
        wrongBtn.addEventListener('click', handleWrongAnswer);
        nextGameBtn.addEventListener('click', startSecondGame);
        
        secondStartBtn.addEventListener('click', startSecondGameRound);
        secondNextBtn.addEventListener('click', revealNextQuartinaStep);
        secondNextQuartinaBtn.addEventListener('click', nextQuartina);
        secondCorrectBtn.addEventListener('click', handleSecondCorrectAnswer);
        secondWrongBtn.addEventListener('click', handleSecondWrongAnswer);
        secondNextGameBtn.addEventListener('click', startThirdGame);
        secondBuzzerA.addEventListener('click', handleSecondBuzzerA);
        secondBuzzerB.addEventListener('click', handleSecondBuzzerB);
        
        // Event listeners per il terzo gioco
        topDirectionBtn.addEventListener('click', () => handleDirectionChoice('top'));
        bottomDirectionBtn.addEventListener('click', () => handleDirectionChoice('bottom'));
        thirdStartBtn.addEventListener('click', startThirdGameRound);
        thirdBuzzer.addEventListener('click', handleThirdBuzzer);
        thirdNextBtn.addEventListener('click', nextChain);
        thirdCorrectBtn.addEventListener('click', handleThirdCorrectAnswer);
        thirdWrongBtn.addEventListener('click', handleThirdWrongAnswer);
        thirdNextGameBtn.addEventListener('click', startFourthGame);
        
        // Event listeners per le opzioni di direzione
        continueDirectionBtn.addEventListener('click', continueDirection);
        changeDirectionBtn.addEventListener('click', changeDirection);
        
        // Event listeners per la ZIP
        playZipBtn.addEventListener('click', handlePlayZip);
        passZipBtn.addEventListener('click', handlePassZip);
        zipCorrectBtn.addEventListener('click', handleZipCorrect);
        zipWrongBtn.addEventListener('click', handleZipWrong);
        
        // Event listeners per L'Intesa Vincente
        fourthStartBtn.addEventListener('click', startIntesaManche);
        fourthBuzzer.addEventListener('click', handleFourthBuzzer);
        fourthCorrectBtn.addEventListener('click', handleFourthCorrectAnswer);
        fourthWrongBtn.addEventListener('click', handleFourthWrongAnswer);
        passBtn.addEventListener('click', handlePass);
        doubleBtn.addEventListener('click', handleDouble);
        fourthNextGameBtn.addEventListener('click', backToMainMenu);
        
        // Inizializza il gioco
        initGame();
    </script>
</body>
</html>
